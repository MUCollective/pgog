<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Examples â€¢ uncertainty.gogr</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Examples">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">uncertainty.gogr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/pgog.html">Examples</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Examples</h1>
                        <h4 class="author">Vignette Author</h4>
            
            <h4 class="date">2019-12-13</h4>
      
      
      <div class="hidden name"><code>pgog.Rmd</code></div>

    </div>

    
    
<p>editor_options: chunk_output_type: console</p>
<div id="override-default-themes" class="section level1">
<h1 class="hasAnchor">
<a href="#override-default-themes" class="anchor"></a>Override default themes</h1>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1">custom_theme &lt;-<span class="st"> </span><span class="kw">theme_minimal</span>() <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1-2" data-line-number="2"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.title.y =</span> <span class="kw">element_blank</span>(),</a>
<a class="sourceLine" id="cb1-3" data-line-number="3">        <span class="dt">axis.text.y =</span> <span class="kw">element_blank</span>(),</a>
<a class="sourceLine" id="cb1-4" data-line-number="4">        <span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">vjust=</span><span class="dv">5</span>),</a>
<a class="sourceLine" id="cb1-5" data-line-number="5">        <span class="dt">panel.grid =</span> <span class="kw">element_blank</span>(),</a>
<a class="sourceLine" id="cb1-6" data-line-number="6">        <span class="dt">axis.ticks =</span> <span class="kw">element_blank</span>(),</a>
<a class="sourceLine" id="cb1-7" data-line-number="7">        <span class="co"># axis.ticks = element_line(),</span></a>
<a class="sourceLine" id="cb1-8" data-line-number="8">        <span class="dt">legend.position =</span> <span class="st">"none"</span></a>
<a class="sourceLine" id="cb1-9" data-line-number="9">  )</a>
<a class="sourceLine" id="cb1-10" data-line-number="10"><span class="kw">theme_set</span>(custom_theme)</a>
<a class="sourceLine" id="cb1-11" data-line-number="11"></a>
<a class="sourceLine" id="cb1-12" data-line-number="12">colorbrewer2 &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/rev.html">rev</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(</a>
<a class="sourceLine" id="cb1-13" data-line-number="13">  <span class="st">"#f7fcf0"</span>,</a>
<a class="sourceLine" id="cb1-14" data-line-number="14">  <span class="st">"#e0f3db"</span>,</a>
<a class="sourceLine" id="cb1-15" data-line-number="15">  <span class="st">"#ccebc5"</span>,</a>
<a class="sourceLine" id="cb1-16" data-line-number="16">  <span class="st">"#a8ddb5"</span>,</a>
<a class="sourceLine" id="cb1-17" data-line-number="17">  <span class="st">"#7bccc4"</span>,</a>
<a class="sourceLine" id="cb1-18" data-line-number="18">  <span class="st">"#4eb3d3"</span>,</a>
<a class="sourceLine" id="cb1-19" data-line-number="19">  <span class="st">"#2b8cbe"</span>,</a>
<a class="sourceLine" id="cb1-20" data-line-number="20">  <span class="st">"#0868ac"</span>,</a>
<a class="sourceLine" id="cb1-21" data-line-number="21">  <span class="st">"#084081"</span>))</a>
<a class="sourceLine" id="cb1-22" data-line-number="22"></a>
<a class="sourceLine" id="cb1-23" data-line-number="23"></a>
<a class="sourceLine" id="cb1-24" data-line-number="24">colorbrewer2_warm &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/rev.html">rev</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(</a>
<a class="sourceLine" id="cb1-25" data-line-number="25">  <span class="st">"#ffffb2"</span>,</a>
<a class="sourceLine" id="cb1-26" data-line-number="26">  <span class="st">"#fecc5c"</span>,</a>
<a class="sourceLine" id="cb1-27" data-line-number="27">  <span class="st">"#fd8d3c"</span>,</a>
<a class="sourceLine" id="cb1-28" data-line-number="28">  <span class="st">"#e31a1c"</span></a>
<a class="sourceLine" id="cb1-29" data-line-number="29">))</a>
<a class="sourceLine" id="cb1-30" data-line-number="30"></a>
<a class="sourceLine" id="cb1-31" data-line-number="31"><span class="kw"><a href="https://rdrr.io/r/base/names.html">names</a></span>(colorbrewer2) &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="kw"><a href="https://rdrr.io/r/base/length.html">length</a></span>(colorbrewer2)</a>
<a class="sourceLine" id="cb1-32" data-line-number="32"></a>
<a class="sourceLine" id="cb1-33" data-line-number="33"></a>
<a class="sourceLine" id="cb1-34" data-line-number="34"><span class="co"># https://stackoverflow.com/questions/10504724/change-the-default-colour-palette-in-ggplot</span></a>
<a class="sourceLine" id="cb1-35" data-line-number="35"><span class="co"># scale_aesthetic_discrete &lt;- function(...) scale_fill_manual(values = colorbrewer2)</span></a>
<a class="sourceLine" id="cb1-36" data-line-number="36">scale_fill_discrete &lt;-<span class="st"> </span><span class="cf">function</span>(...) <span class="kw">scale_fill_manual</span>(<span class="dt">values =</span> colorbrewer2)</a>
<a class="sourceLine" id="cb1-37" data-line-number="37"></a>
<a class="sourceLine" id="cb1-38" data-line-number="38"><span class="co"># to our great dismay scale_color_* doesn't work</span></a>
<a class="sourceLine" id="cb1-39" data-line-number="39">scale_colour_discrete &lt;-<span class="st"> </span><span class="cf">function</span>(...) <span class="kw">scale_colour_manual</span>(<span class="dt">values =</span> colorbrewer2_warm)</a></code></pre></div>
</div>
<div id="geom_bloc" class="section level1">
<h1 class="hasAnchor">
<a href="#geom_bloc" class="anchor"></a>geom_bloc</h1>
<div id="product-plots" class="section level2">
<h2 class="hasAnchor">
<a href="#product-plots" class="anchor"></a>product plots</h2>
<p>P(A)</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="kw">ggplot</span>(mtcars) <span class="op">+</span><span class="st"> </span><span class="kw">geom_bloc</span>(<span class="kw">aes</span>(<span class="dt">width =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="kw">P</span>(cyl)))) </a>
<a class="sourceLine" id="cb2-2" data-line-number="2"><span class="co">#&gt;   marg cond   aes level</span></a>
<a class="sourceLine" id="cb2-3" data-line-number="3"><span class="co">#&gt; 1  cyl      width     1</span></a>
<a class="sourceLine" id="cb2-4" data-line-number="4"><span class="co">#&gt; Warning: Outer names are only allowed for unnamed scalar atomic inputs</span></a>
<a class="sourceLine" id="cb2-5" data-line-number="5"></a>
<a class="sourceLine" id="cb2-6" data-line-number="6"><span class="co">#&gt; Warning: Outer names are only allowed for unnamed scalar atomic inputs</span></a>
<a class="sourceLine" id="cb2-7" data-line-number="7"><span class="co">#&gt; Aesthetic mapping: </span></a>
<a class="sourceLine" id="cb2-8" data-line-number="8"><span class="co">#&gt; * `p.cyl` -&gt; `cyl`</span></a>
<a class="sourceLine" id="cb2-9" data-line-number="9"><span class="co">#&gt; * `x`     -&gt; 1</span></a>
<a class="sourceLine" id="cb2-10" data-line-number="10"><span class="co">#&gt; * `y`     -&gt; 1</span></a>
<a class="sourceLine" id="cb2-11" data-line-number="11"><span class="co">#&gt; Don't know how to automatically pick scale for object of type pgog. Defaulting to continuous.</span></a>
<a class="sourceLine" id="cb2-12" data-line-number="12"><span class="co">#&gt; Don't know how to automatically pick scale for object of type pgog. Defaulting to continuous.</span></a>
<a class="sourceLine" id="cb2-13" data-line-number="13"><span class="co">#&gt; Warning: Outer names are only allowed for unnamed scalar atomic inputs</span></a>
<a class="sourceLine" id="cb2-14" data-line-number="14"></a>
<a class="sourceLine" id="cb2-15" data-line-number="15"><span class="co">#&gt; Warning: Outer names are only allowed for unnamed scalar atomic inputs</span></a>
<a class="sourceLine" id="cb2-16" data-line-number="16"><span class="co">#&gt; Defaulting to mosaic plots. Use `stat=blocdensity` to force density plots</span></a></code></pre></div>
<p><img src="pgog_files/figure-html/unnamed-chunk-2-1.png" width="700"></p>
<pre><code>#&gt; Called from: f(..., self = self)
#&gt; debug: if ("density" %in% names(data)) {
#&gt;     data &lt;- transform(data[order(data$PANEL, data$group, data$x), 
#&gt;         ], ymin = 0, ymax = y)
#&gt;     if ("height" %in% names(data)) {
#&gt;         if (is.null(params$panel_scaling)) {
#&gt;             params$panel_scaling &lt;- TRUE
#&gt;         }
#&gt;         yrange = max(data$y) - min(data$y)
#&gt;         n = length(unique(data$y))
#&gt;         if (n &lt; 2) {
#&gt;             hmax &lt;- max(data$height, na.rm = TRUE)
#&gt;             iscale &lt;- 1
#&gt;         }
#&gt;         else {
#&gt;             if (params$panel_scaling) {
#&gt;                 heights &lt;- split(data$height, data$PANEL)
#&gt;                 max_heights &lt;- vapply(heights, max, numeric(1), 
#&gt;                   na.rm = TRUE)
#&gt;                 hmax &lt;- max_heights[data$PANEL]
#&gt;                 iscale &lt;- yrange/((n - 1) * hmax)
#&gt;             }
#&gt;             else {
#&gt;                 hmax &lt;- max(data$height, na.rm = TRUE)
#&gt;                 iscale &lt;- yrange/((n - 1) * hmax)
#&gt;             }
#&gt;         }
#&gt;         data &lt;- cbind(data, iscale)
#&gt;         if (!"scale" %in% names(data)) {
#&gt;             if (!"scale" %in% names(params)) 
#&gt;                 data &lt;- cbind(data, scale = self$default_aes$scale)
#&gt;             else data &lt;- cbind(data, scale = params$scale)
#&gt;         }
#&gt;         if (!"rel_min_height" %in% names(data)) {
#&gt;             if (!"rel_min_height" %in% names(params)) 
#&gt;                 data &lt;- cbind(data, rel_min_height = self$default_aes$rel_min_height)
#&gt;             else data &lt;- cbind(data, rel_min_height = params$rel_min_height)
#&gt;         }
#&gt;         data &lt;- transform(data, ymin = y, ymax = y + iscale * 
#&gt;             scale * height, min_height = hmax * rel_min_height)
#&gt;         return(data)
#&gt;     }
#&gt;     data
#&gt; } else {
#&gt;     subset(data, level == max(data$level))
#&gt; }
#&gt; debug: subset(data, level == max(data$level))</code></pre>
<p>P(A|B)</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1"><span class="kw">ggplot</span>(mtcars) <span class="op">+</span><span class="st"> </span><span class="kw">geom_bloc</span>(<span class="kw">aes</span>(<span class="dt">height =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="kw">P</span>(cyl<span class="op">|</span>gear)), <span class="dt">x =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(gear)))</a>
<a class="sourceLine" id="cb4-2" data-line-number="2"><span class="co">#&gt;   marg cond    aes level</span></a>
<a class="sourceLine" id="cb4-3" data-line-number="3"><span class="co">#&gt; 1    1 gear x.cond     1</span></a>
<a class="sourceLine" id="cb4-4" data-line-number="4"><span class="co">#&gt; 2  cyl gear height     2</span></a>
<a class="sourceLine" id="cb4-5" data-line-number="5"><span class="co">#&gt; Warning: Outer names are only allowed for unnamed scalar atomic inputs</span></a>
<a class="sourceLine" id="cb4-6" data-line-number="6"></a>
<a class="sourceLine" id="cb4-7" data-line-number="7"><span class="co">#&gt; Warning: Outer names are only allowed for unnamed scalar atomic inputs</span></a>
<a class="sourceLine" id="cb4-8" data-line-number="8"></a>
<a class="sourceLine" id="cb4-9" data-line-number="9"><span class="co">#&gt; Warning: Outer names are only allowed for unnamed scalar atomic inputs</span></a>
<a class="sourceLine" id="cb4-10" data-line-number="10"><span class="co">#&gt; Aesthetic mapping: </span></a>
<a class="sourceLine" id="cb4-11" data-line-number="11"><span class="co">#&gt; * `x`      -&gt; 1</span></a>
<a class="sourceLine" id="cb4-12" data-line-number="12"><span class="co">#&gt; * `p.cyl`  -&gt; `cyl`</span></a>
<a class="sourceLine" id="cb4-13" data-line-number="13"><span class="co">#&gt; * `p.gear` -&gt; `gear`</span></a>
<a class="sourceLine" id="cb4-14" data-line-number="14"><span class="co">#&gt; * `y`      -&gt; 1</span></a>
<a class="sourceLine" id="cb4-15" data-line-number="15"><span class="co">#&gt; Don't know how to automatically pick scale for object of type pgog. Defaulting to continuous.</span></a>
<a class="sourceLine" id="cb4-16" data-line-number="16"><span class="co">#&gt; Don't know how to automatically pick scale for object of type pgog. Defaulting to continuous.</span></a>
<a class="sourceLine" id="cb4-17" data-line-number="17"><span class="co">#&gt; Warning: Outer names are only allowed for unnamed scalar atomic inputs</span></a>
<a class="sourceLine" id="cb4-18" data-line-number="18"></a>
<a class="sourceLine" id="cb4-19" data-line-number="19"><span class="co">#&gt; Warning: Outer names are only allowed for unnamed scalar atomic inputs</span></a>
<a class="sourceLine" id="cb4-20" data-line-number="20"></a>
<a class="sourceLine" id="cb4-21" data-line-number="21"><span class="co">#&gt; Warning: Outer names are only allowed for unnamed scalar atomic inputs</span></a>
<a class="sourceLine" id="cb4-22" data-line-number="22"><span class="co">#&gt; Defaulting to mosaic plots. Use `stat=blocdensity` to force density plots</span></a></code></pre></div>
<p><img src="pgog_files/figure-html/unnamed-chunk-3-1.png" width="700"></p>
<pre><code>#&gt; Called from: f(..., self = self)
#&gt; debug: if ("density" %in% names(data)) {
#&gt;     data &lt;- transform(data[order(data$PANEL, data$group, data$x), 
#&gt;         ], ymin = 0, ymax = y)
#&gt;     if ("height" %in% names(data)) {
#&gt;         if (is.null(params$panel_scaling)) {
#&gt;             params$panel_scaling &lt;- TRUE
#&gt;         }
#&gt;         yrange = max(data$y) - min(data$y)
#&gt;         n = length(unique(data$y))
#&gt;         if (n &lt; 2) {
#&gt;             hmax &lt;- max(data$height, na.rm = TRUE)
#&gt;             iscale &lt;- 1
#&gt;         }
#&gt;         else {
#&gt;             if (params$panel_scaling) {
#&gt;                 heights &lt;- split(data$height, data$PANEL)
#&gt;                 max_heights &lt;- vapply(heights, max, numeric(1), 
#&gt;                   na.rm = TRUE)
#&gt;                 hmax &lt;- max_heights[data$PANEL]
#&gt;                 iscale &lt;- yrange/((n - 1) * hmax)
#&gt;             }
#&gt;             else {
#&gt;                 hmax &lt;- max(data$height, na.rm = TRUE)
#&gt;                 iscale &lt;- yrange/((n - 1) * hmax)
#&gt;             }
#&gt;         }
#&gt;         data &lt;- cbind(data, iscale)
#&gt;         if (!"scale" %in% names(data)) {
#&gt;             if (!"scale" %in% names(params)) 
#&gt;                 data &lt;- cbind(data, scale = self$default_aes$scale)
#&gt;             else data &lt;- cbind(data, scale = params$scale)
#&gt;         }
#&gt;         if (!"rel_min_height" %in% names(data)) {
#&gt;             if (!"rel_min_height" %in% names(params)) 
#&gt;                 data &lt;- cbind(data, rel_min_height = self$default_aes$rel_min_height)
#&gt;             else data &lt;- cbind(data, rel_min_height = params$rel_min_height)
#&gt;         }
#&gt;         data &lt;- transform(data, ymin = y, ymax = y + iscale * 
#&gt;             scale * height, min_height = hmax * rel_min_height)
#&gt;         return(data)
#&gt;     }
#&gt;     data
#&gt; } else {
#&gt;     subset(data, level == max(data$level))
#&gt; }
#&gt; debug: subset(data, level == max(data$level))</code></pre>
<p>P(A)</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1"><span class="kw">ggplot</span>(mtcars) <span class="op">+</span><span class="st"> </span><span class="kw">geom_bloc</span>(<span class="kw">aes</span>(<span class="dt">height =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="kw">P</span>(cyl)), <span class="dt">x =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(cyl)))</a>
<a class="sourceLine" id="cb6-2" data-line-number="2"><span class="co">#&gt;   marg cond      aes level</span></a>
<a class="sourceLine" id="cb6-3" data-line-number="3"><span class="co">#&gt; 1  cyl      x.height     1</span></a>
<a class="sourceLine" id="cb6-4" data-line-number="4"><span class="co">#&gt; Warning: Outer names are only allowed for unnamed scalar atomic inputs</span></a>
<a class="sourceLine" id="cb6-5" data-line-number="5"></a>
<a class="sourceLine" id="cb6-6" data-line-number="6"><span class="co">#&gt; Warning: Outer names are only allowed for unnamed scalar atomic inputs</span></a>
<a class="sourceLine" id="cb6-7" data-line-number="7"><span class="co">#&gt; Aesthetic mapping: </span></a>
<a class="sourceLine" id="cb6-8" data-line-number="8"><span class="co">#&gt; * `x`     -&gt; 1</span></a>
<a class="sourceLine" id="cb6-9" data-line-number="9"><span class="co">#&gt; * `p.cyl` -&gt; `cyl`</span></a>
<a class="sourceLine" id="cb6-10" data-line-number="10"><span class="co">#&gt; * `y`     -&gt; 1</span></a>
<a class="sourceLine" id="cb6-11" data-line-number="11"><span class="co">#&gt; Don't know how to automatically pick scale for object of type pgog. Defaulting to continuous.</span></a>
<a class="sourceLine" id="cb6-12" data-line-number="12"><span class="co">#&gt; Don't know how to automatically pick scale for object of type pgog. Defaulting to continuous.</span></a>
<a class="sourceLine" id="cb6-13" data-line-number="13"><span class="co">#&gt; Warning: Outer names are only allowed for unnamed scalar atomic inputs</span></a>
<a class="sourceLine" id="cb6-14" data-line-number="14"></a>
<a class="sourceLine" id="cb6-15" data-line-number="15"><span class="co">#&gt; Warning: Outer names are only allowed for unnamed scalar atomic inputs</span></a>
<a class="sourceLine" id="cb6-16" data-line-number="16"><span class="co">#&gt; Defaulting to mosaic plots. Use `stat=blocdensity` to force density plots</span></a></code></pre></div>
<p><img src="pgog_files/figure-html/unnamed-chunk-4-1.png" width="700"></p>
<pre><code>#&gt; Called from: f(..., self = self)
#&gt; debug: if ("density" %in% names(data)) {
#&gt;     data &lt;- transform(data[order(data$PANEL, data$group, data$x), 
#&gt;         ], ymin = 0, ymax = y)
#&gt;     if ("height" %in% names(data)) {
#&gt;         if (is.null(params$panel_scaling)) {
#&gt;             params$panel_scaling &lt;- TRUE
#&gt;         }
#&gt;         yrange = max(data$y) - min(data$y)
#&gt;         n = length(unique(data$y))
#&gt;         if (n &lt; 2) {
#&gt;             hmax &lt;- max(data$height, na.rm = TRUE)
#&gt;             iscale &lt;- 1
#&gt;         }
#&gt;         else {
#&gt;             if (params$panel_scaling) {
#&gt;                 heights &lt;- split(data$height, data$PANEL)
#&gt;                 max_heights &lt;- vapply(heights, max, numeric(1), 
#&gt;                   na.rm = TRUE)
#&gt;                 hmax &lt;- max_heights[data$PANEL]
#&gt;                 iscale &lt;- yrange/((n - 1) * hmax)
#&gt;             }
#&gt;             else {
#&gt;                 hmax &lt;- max(data$height, na.rm = TRUE)
#&gt;                 iscale &lt;- yrange/((n - 1) * hmax)
#&gt;             }
#&gt;         }
#&gt;         data &lt;- cbind(data, iscale)
#&gt;         if (!"scale" %in% names(data)) {
#&gt;             if (!"scale" %in% names(params)) 
#&gt;                 data &lt;- cbind(data, scale = self$default_aes$scale)
#&gt;             else data &lt;- cbind(data, scale = params$scale)
#&gt;         }
#&gt;         if (!"rel_min_height" %in% names(data)) {
#&gt;             if (!"rel_min_height" %in% names(params)) 
#&gt;                 data &lt;- cbind(data, rel_min_height = self$default_aes$rel_min_height)
#&gt;             else data &lt;- cbind(data, rel_min_height = params$rel_min_height)
#&gt;         }
#&gt;         data &lt;- transform(data, ymin = y, ymax = y + iscale * 
#&gt;             scale * height, min_height = hmax * rel_min_height)
#&gt;         return(data)
#&gt;     }
#&gt;     data
#&gt; } else {
#&gt;     subset(data, level == max(data$level))
#&gt; }
#&gt; debug: subset(data, level == max(data$level))</code></pre>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1"><span class="kw">ggplot</span>(mtcars) <span class="op">+</span><span class="st"> </span><span class="kw">geom_bloc</span>(<span class="kw">aes</span>(<span class="dt">height =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="kw">P</span>(cyl<span class="op">|</span>gear, carb)), <span class="dt">x =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(gear, carb)))</a>
<a class="sourceLine" id="cb8-2" data-line-number="2"><span class="co">#&gt;   marg      cond    aes level</span></a>
<a class="sourceLine" id="cb8-3" data-line-number="3"><span class="co">#&gt; 1    1      carb x.cond     1</span></a>
<a class="sourceLine" id="cb8-4" data-line-number="4"><span class="co">#&gt; 2    1      gear x.cond     2</span></a>
<a class="sourceLine" id="cb8-5" data-line-number="5"><span class="co">#&gt; 3  cyl gear,carb height     3</span></a>
<a class="sourceLine" id="cb8-6" data-line-number="6"><span class="co">#&gt; Warning: Outer names are only allowed for unnamed scalar atomic inputs</span></a>
<a class="sourceLine" id="cb8-7" data-line-number="7"></a>
<a class="sourceLine" id="cb8-8" data-line-number="8"><span class="co">#&gt; Warning: Outer names are only allowed for unnamed scalar atomic inputs</span></a>
<a class="sourceLine" id="cb8-9" data-line-number="9"></a>
<a class="sourceLine" id="cb8-10" data-line-number="10"><span class="co">#&gt; Warning: Outer names are only allowed for unnamed scalar atomic inputs</span></a>
<a class="sourceLine" id="cb8-11" data-line-number="11"><span class="co">#&gt; Aesthetic mapping: </span></a>
<a class="sourceLine" id="cb8-12" data-line-number="12"><span class="co">#&gt; * `x`      -&gt; 1</span></a>
<a class="sourceLine" id="cb8-13" data-line-number="13"><span class="co">#&gt; * `p.cyl`  -&gt; `cyl`</span></a>
<a class="sourceLine" id="cb8-14" data-line-number="14"><span class="co">#&gt; * `p.gear` -&gt; `gear`</span></a>
<a class="sourceLine" id="cb8-15" data-line-number="15"><span class="co">#&gt; * `p.carb` -&gt; `carb`</span></a>
<a class="sourceLine" id="cb8-16" data-line-number="16"><span class="co">#&gt; * `y`      -&gt; 1</span></a>
<a class="sourceLine" id="cb8-17" data-line-number="17"><span class="co">#&gt; Don't know how to automatically pick scale for object of type pgog. Defaulting to continuous.</span></a>
<a class="sourceLine" id="cb8-18" data-line-number="18"><span class="co">#&gt; Don't know how to automatically pick scale for object of type pgog. Defaulting to continuous.</span></a>
<a class="sourceLine" id="cb8-19" data-line-number="19"><span class="co">#&gt; Warning: Outer names are only allowed for unnamed scalar atomic inputs</span></a>
<a class="sourceLine" id="cb8-20" data-line-number="20"></a>
<a class="sourceLine" id="cb8-21" data-line-number="21"><span class="co">#&gt; Warning: Outer names are only allowed for unnamed scalar atomic inputs</span></a>
<a class="sourceLine" id="cb8-22" data-line-number="22"></a>
<a class="sourceLine" id="cb8-23" data-line-number="23"><span class="co">#&gt; Warning: Outer names are only allowed for unnamed scalar atomic inputs</span></a>
<a class="sourceLine" id="cb8-24" data-line-number="24"><span class="co">#&gt; Defaulting to mosaic plots. Use `stat=blocdensity` to force density plots</span></a>
<a class="sourceLine" id="cb8-25" data-line-number="25"><span class="co">#&gt; Warning in max(wt, na.rm = TRUE): no non-missing arguments to max; returning -</span></a>
<a class="sourceLine" id="cb8-26" data-line-number="26"><span class="co">#&gt; Inf</span></a>
<a class="sourceLine" id="cb8-27" data-line-number="27"><span class="co">#&gt; Warning in max(wt, na.rm = TRUE): no non-missing arguments to max; returning -</span></a>
<a class="sourceLine" id="cb8-28" data-line-number="28"><span class="co">#&gt; Inf</span></a>
<a class="sourceLine" id="cb8-29" data-line-number="29"></a>
<a class="sourceLine" id="cb8-30" data-line-number="30"><span class="co">#&gt; Warning in max(wt, na.rm = TRUE): no non-missing arguments to max; returning -</span></a>
<a class="sourceLine" id="cb8-31" data-line-number="31"><span class="co">#&gt; Inf</span></a>
<a class="sourceLine" id="cb8-32" data-line-number="32"></a>
<a class="sourceLine" id="cb8-33" data-line-number="33"><span class="co">#&gt; Warning in max(wt, na.rm = TRUE): no non-missing arguments to max; returning -</span></a>
<a class="sourceLine" id="cb8-34" data-line-number="34"><span class="co">#&gt; Inf</span></a>
<a class="sourceLine" id="cb8-35" data-line-number="35"></a>
<a class="sourceLine" id="cb8-36" data-line-number="36"><span class="co">#&gt; Warning in max(wt, na.rm = TRUE): no non-missing arguments to max; returning -</span></a>
<a class="sourceLine" id="cb8-37" data-line-number="37"><span class="co">#&gt; Inf</span></a>
<a class="sourceLine" id="cb8-38" data-line-number="38"></a>
<a class="sourceLine" id="cb8-39" data-line-number="39"><span class="co">#&gt; Warning in max(wt, na.rm = TRUE): no non-missing arguments to max; returning -</span></a>
<a class="sourceLine" id="cb8-40" data-line-number="40"><span class="co">#&gt; Inf</span></a>
<a class="sourceLine" id="cb8-41" data-line-number="41"></a>
<a class="sourceLine" id="cb8-42" data-line-number="42"><span class="co">#&gt; Warning in max(wt, na.rm = TRUE): no non-missing arguments to max; returning -</span></a>
<a class="sourceLine" id="cb8-43" data-line-number="43"><span class="co">#&gt; Inf</span></a></code></pre></div>
<p><img src="pgog_files/figure-html/unnamed-chunk-5-1.png" width="700"></p>
<pre><code>#&gt; Called from: f(..., self = self)
#&gt; debug: if ("density" %in% names(data)) {
#&gt;     data &lt;- transform(data[order(data$PANEL, data$group, data$x), 
#&gt;         ], ymin = 0, ymax = y)
#&gt;     if ("height" %in% names(data)) {
#&gt;         if (is.null(params$panel_scaling)) {
#&gt;             params$panel_scaling &lt;- TRUE
#&gt;         }
#&gt;         yrange = max(data$y) - min(data$y)
#&gt;         n = length(unique(data$y))
#&gt;         if (n &lt; 2) {
#&gt;             hmax &lt;- max(data$height, na.rm = TRUE)
#&gt;             iscale &lt;- 1
#&gt;         }
#&gt;         else {
#&gt;             if (params$panel_scaling) {
#&gt;                 heights &lt;- split(data$height, data$PANEL)
#&gt;                 max_heights &lt;- vapply(heights, max, numeric(1), 
#&gt;                   na.rm = TRUE)
#&gt;                 hmax &lt;- max_heights[data$PANEL]
#&gt;                 iscale &lt;- yrange/((n - 1) * hmax)
#&gt;             }
#&gt;             else {
#&gt;                 hmax &lt;- max(data$height, na.rm = TRUE)
#&gt;                 iscale &lt;- yrange/((n - 1) * hmax)
#&gt;             }
#&gt;         }
#&gt;         data &lt;- cbind(data, iscale)
#&gt;         if (!"scale" %in% names(data)) {
#&gt;             if (!"scale" %in% names(params)) 
#&gt;                 data &lt;- cbind(data, scale = self$default_aes$scale)
#&gt;             else data &lt;- cbind(data, scale = params$scale)
#&gt;         }
#&gt;         if (!"rel_min_height" %in% names(data)) {
#&gt;             if (!"rel_min_height" %in% names(params)) 
#&gt;                 data &lt;- cbind(data, rel_min_height = self$default_aes$rel_min_height)
#&gt;             else data &lt;- cbind(data, rel_min_height = params$rel_min_height)
#&gt;         }
#&gt;         data &lt;- transform(data, ymin = y, ymax = y + iscale * 
#&gt;             scale * height, min_height = hmax * rel_min_height)
#&gt;         return(data)
#&gt;     }
#&gt;     data
#&gt; } else {
#&gt;     subset(data, level == max(data$level))
#&gt; }
#&gt; debug: subset(data, level == max(data$level))</code></pre>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1"><span class="kw">ggplot</span>(mtcars) <span class="op">+</span><span class="st"> </span><span class="kw">geom_bloc</span>(<span class="kw">aes</span>(<span class="dt">height =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="kw">P</span>(cyl<span class="op">|</span>gear, carb)), <span class="dt">x =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(gear), <span class="dt">y=</span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(carb)))</a>
<a class="sourceLine" id="cb10-2" data-line-number="2"><span class="co">#&gt;   marg      cond    aes level</span></a>
<a class="sourceLine" id="cb10-3" data-line-number="3"><span class="co">#&gt; 1    1      carb y.cond     1</span></a>
<a class="sourceLine" id="cb10-4" data-line-number="4"><span class="co">#&gt; 2    1      gear x.cond     2</span></a>
<a class="sourceLine" id="cb10-5" data-line-number="5"><span class="co">#&gt; 3  cyl gear,carb height     3</span></a>
<a class="sourceLine" id="cb10-6" data-line-number="6"><span class="co">#&gt; Warning: Outer names are only allowed for unnamed scalar atomic inputs</span></a>
<a class="sourceLine" id="cb10-7" data-line-number="7"></a>
<a class="sourceLine" id="cb10-8" data-line-number="8"><span class="co">#&gt; Warning: Outer names are only allowed for unnamed scalar atomic inputs</span></a>
<a class="sourceLine" id="cb10-9" data-line-number="9"></a>
<a class="sourceLine" id="cb10-10" data-line-number="10"><span class="co">#&gt; Warning: Outer names are only allowed for unnamed scalar atomic inputs</span></a>
<a class="sourceLine" id="cb10-11" data-line-number="11"><span class="co">#&gt; Aesthetic mapping: </span></a>
<a class="sourceLine" id="cb10-12" data-line-number="12"><span class="co">#&gt; * `x`      -&gt; 1</span></a>
<a class="sourceLine" id="cb10-13" data-line-number="13"><span class="co">#&gt; * `y`      -&gt; 1</span></a>
<a class="sourceLine" id="cb10-14" data-line-number="14"><span class="co">#&gt; * `p.cyl`  -&gt; `cyl`</span></a>
<a class="sourceLine" id="cb10-15" data-line-number="15"><span class="co">#&gt; * `p.gear` -&gt; `gear`</span></a>
<a class="sourceLine" id="cb10-16" data-line-number="16"><span class="co">#&gt; * `p.carb` -&gt; `carb`</span></a>
<a class="sourceLine" id="cb10-17" data-line-number="17"><span class="co">#&gt; Don't know how to automatically pick scale for object of type pgog. Defaulting to continuous.</span></a>
<a class="sourceLine" id="cb10-18" data-line-number="18"><span class="co">#&gt; Don't know how to automatically pick scale for object of type pgog. Defaulting to continuous.</span></a>
<a class="sourceLine" id="cb10-19" data-line-number="19"><span class="co">#&gt; Warning: Outer names are only allowed for unnamed scalar atomic inputs</span></a>
<a class="sourceLine" id="cb10-20" data-line-number="20"></a>
<a class="sourceLine" id="cb10-21" data-line-number="21"><span class="co">#&gt; Warning: Outer names are only allowed for unnamed scalar atomic inputs</span></a>
<a class="sourceLine" id="cb10-22" data-line-number="22"></a>
<a class="sourceLine" id="cb10-23" data-line-number="23"><span class="co">#&gt; Warning: Outer names are only allowed for unnamed scalar atomic inputs</span></a>
<a class="sourceLine" id="cb10-24" data-line-number="24"><span class="co">#&gt; Defaulting to mosaic plots. Use `stat=blocdensity` to force density plots</span></a>
<a class="sourceLine" id="cb10-25" data-line-number="25"><span class="co">#&gt; Warning in max(wt, na.rm = TRUE): no non-missing arguments to max; returning -</span></a>
<a class="sourceLine" id="cb10-26" data-line-number="26"><span class="co">#&gt; Inf</span></a>
<a class="sourceLine" id="cb10-27" data-line-number="27"><span class="co">#&gt; Warning in max(wt, na.rm = TRUE): no non-missing arguments to max; returning -</span></a>
<a class="sourceLine" id="cb10-28" data-line-number="28"><span class="co">#&gt; Inf</span></a>
<a class="sourceLine" id="cb10-29" data-line-number="29"></a>
<a class="sourceLine" id="cb10-30" data-line-number="30"><span class="co">#&gt; Warning in max(wt, na.rm = TRUE): no non-missing arguments to max; returning -</span></a>
<a class="sourceLine" id="cb10-31" data-line-number="31"><span class="co">#&gt; Inf</span></a>
<a class="sourceLine" id="cb10-32" data-line-number="32"></a>
<a class="sourceLine" id="cb10-33" data-line-number="33"><span class="co">#&gt; Warning in max(wt, na.rm = TRUE): no non-missing arguments to max; returning -</span></a>
<a class="sourceLine" id="cb10-34" data-line-number="34"><span class="co">#&gt; Inf</span></a>
<a class="sourceLine" id="cb10-35" data-line-number="35"></a>
<a class="sourceLine" id="cb10-36" data-line-number="36"><span class="co">#&gt; Warning in max(wt, na.rm = TRUE): no non-missing arguments to max; returning -</span></a>
<a class="sourceLine" id="cb10-37" data-line-number="37"><span class="co">#&gt; Inf</span></a>
<a class="sourceLine" id="cb10-38" data-line-number="38"></a>
<a class="sourceLine" id="cb10-39" data-line-number="39"><span class="co">#&gt; Warning in max(wt, na.rm = TRUE): no non-missing arguments to max; returning -</span></a>
<a class="sourceLine" id="cb10-40" data-line-number="40"><span class="co">#&gt; Inf</span></a>
<a class="sourceLine" id="cb10-41" data-line-number="41"></a>
<a class="sourceLine" id="cb10-42" data-line-number="42"><span class="co">#&gt; Warning in max(wt, na.rm = TRUE): no non-missing arguments to max; returning -</span></a>
<a class="sourceLine" id="cb10-43" data-line-number="43"><span class="co">#&gt; Inf</span></a></code></pre></div>
<p><img src="pgog_files/figure-html/unnamed-chunk-6-1.png" width="700"></p>
<pre><code>#&gt; Called from: f(..., self = self)
#&gt; debug: if ("density" %in% names(data)) {
#&gt;     data &lt;- transform(data[order(data$PANEL, data$group, data$x), 
#&gt;         ], ymin = 0, ymax = y)
#&gt;     if ("height" %in% names(data)) {
#&gt;         if (is.null(params$panel_scaling)) {
#&gt;             params$panel_scaling &lt;- TRUE
#&gt;         }
#&gt;         yrange = max(data$y) - min(data$y)
#&gt;         n = length(unique(data$y))
#&gt;         if (n &lt; 2) {
#&gt;             hmax &lt;- max(data$height, na.rm = TRUE)
#&gt;             iscale &lt;- 1
#&gt;         }
#&gt;         else {
#&gt;             if (params$panel_scaling) {
#&gt;                 heights &lt;- split(data$height, data$PANEL)
#&gt;                 max_heights &lt;- vapply(heights, max, numeric(1), 
#&gt;                   na.rm = TRUE)
#&gt;                 hmax &lt;- max_heights[data$PANEL]
#&gt;                 iscale &lt;- yrange/((n - 1) * hmax)
#&gt;             }
#&gt;             else {
#&gt;                 hmax &lt;- max(data$height, na.rm = TRUE)
#&gt;                 iscale &lt;- yrange/((n - 1) * hmax)
#&gt;             }
#&gt;         }
#&gt;         data &lt;- cbind(data, iscale)
#&gt;         if (!"scale" %in% names(data)) {
#&gt;             if (!"scale" %in% names(params)) 
#&gt;                 data &lt;- cbind(data, scale = self$default_aes$scale)
#&gt;             else data &lt;- cbind(data, scale = params$scale)
#&gt;         }
#&gt;         if (!"rel_min_height" %in% names(data)) {
#&gt;             if (!"rel_min_height" %in% names(params)) 
#&gt;                 data &lt;- cbind(data, rel_min_height = self$default_aes$rel_min_height)
#&gt;             else data &lt;- cbind(data, rel_min_height = params$rel_min_height)
#&gt;         }
#&gt;         data &lt;- transform(data, ymin = y, ymax = y + iscale * 
#&gt;             scale * height, min_height = hmax * rel_min_height)
#&gt;         return(data)
#&gt;     }
#&gt;     data
#&gt; } else {
#&gt;     subset(data, level == max(data$level))
#&gt; }
#&gt; debug: subset(data, level == max(data$level))</code></pre>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" data-line-number="1"><span class="kw">ggplot</span>(mtcars) <span class="op">+</span><span class="st"> </span><span class="kw">geom_bloc</span>(<span class="kw">aes</span>(<span class="dt">height =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="kw">P</span>(gear<span class="op">|</span>am), <span class="kw">P</span>(cyl<span class="op">|</span>gear, am)), </a>
<a class="sourceLine" id="cb12-2" data-line-number="2">                               <span class="dt">x =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(am)))</a>
<a class="sourceLine" id="cb12-3" data-line-number="3"><span class="co">#&gt;   marg    cond    aes level</span></a>
<a class="sourceLine" id="cb12-4" data-line-number="4"><span class="co">#&gt; 1    1      am x.cond     1</span></a>
<a class="sourceLine" id="cb12-5" data-line-number="5"><span class="co">#&gt; 2 gear      am height     2</span></a>
<a class="sourceLine" id="cb12-6" data-line-number="6"><span class="co">#&gt; 3  cyl gear,am height     3</span></a>
<a class="sourceLine" id="cb12-7" data-line-number="7"><span class="co">#&gt; Aesthetic mapping: </span></a>
<a class="sourceLine" id="cb12-8" data-line-number="8"><span class="co">#&gt; * `x`      -&gt; 1</span></a>
<a class="sourceLine" id="cb12-9" data-line-number="9"><span class="co">#&gt; * `p.cyl`  -&gt; `cyl`</span></a>
<a class="sourceLine" id="cb12-10" data-line-number="10"><span class="co">#&gt; * `p.gear` -&gt; `gear`</span></a>
<a class="sourceLine" id="cb12-11" data-line-number="11"><span class="co">#&gt; * `p.am`   -&gt; `am`</span></a>
<a class="sourceLine" id="cb12-12" data-line-number="12"><span class="co">#&gt; * `y`      -&gt; 1</span></a>
<a class="sourceLine" id="cb12-13" data-line-number="13"><span class="co">#&gt; Don't know how to automatically pick scale for object of type pgog. Defaulting to continuous.</span></a>
<a class="sourceLine" id="cb12-14" data-line-number="14"><span class="co">#&gt; Don't know how to automatically pick scale for object of type pgog. Defaulting to continuous.</span></a>
<a class="sourceLine" id="cb12-15" data-line-number="15"><span class="co">#&gt; Defaulting to mosaic plots. Use `stat=blocdensity` to force density plots</span></a>
<a class="sourceLine" id="cb12-16" data-line-number="16"><span class="co">#&gt; Warning in max(wt, na.rm = TRUE): no non-missing arguments to max; returning -</span></a>
<a class="sourceLine" id="cb12-17" data-line-number="17"><span class="co">#&gt; Inf</span></a>
<a class="sourceLine" id="cb12-18" data-line-number="18"></a>
<a class="sourceLine" id="cb12-19" data-line-number="19"><span class="co">#&gt; Warning in max(wt, na.rm = TRUE): no non-missing arguments to max; returning -</span></a>
<a class="sourceLine" id="cb12-20" data-line-number="20"><span class="co">#&gt; Inf</span></a></code></pre></div>
<p><img src="pgog_files/figure-html/unnamed-chunk-7-1.png" width="700"></p>
<pre><code>#&gt; Called from: f(..., self = self)
#&gt; debug: if ("density" %in% names(data)) {
#&gt;     data &lt;- transform(data[order(data$PANEL, data$group, data$x), 
#&gt;         ], ymin = 0, ymax = y)
#&gt;     if ("height" %in% names(data)) {
#&gt;         if (is.null(params$panel_scaling)) {
#&gt;             params$panel_scaling &lt;- TRUE
#&gt;         }
#&gt;         yrange = max(data$y) - min(data$y)
#&gt;         n = length(unique(data$y))
#&gt;         if (n &lt; 2) {
#&gt;             hmax &lt;- max(data$height, na.rm = TRUE)
#&gt;             iscale &lt;- 1
#&gt;         }
#&gt;         else {
#&gt;             if (params$panel_scaling) {
#&gt;                 heights &lt;- split(data$height, data$PANEL)
#&gt;                 max_heights &lt;- vapply(heights, max, numeric(1), 
#&gt;                   na.rm = TRUE)
#&gt;                 hmax &lt;- max_heights[data$PANEL]
#&gt;                 iscale &lt;- yrange/((n - 1) * hmax)
#&gt;             }
#&gt;             else {
#&gt;                 hmax &lt;- max(data$height, na.rm = TRUE)
#&gt;                 iscale &lt;- yrange/((n - 1) * hmax)
#&gt;             }
#&gt;         }
#&gt;         data &lt;- cbind(data, iscale)
#&gt;         if (!"scale" %in% names(data)) {
#&gt;             if (!"scale" %in% names(params)) 
#&gt;                 data &lt;- cbind(data, scale = self$default_aes$scale)
#&gt;             else data &lt;- cbind(data, scale = params$scale)
#&gt;         }
#&gt;         if (!"rel_min_height" %in% names(data)) {
#&gt;             if (!"rel_min_height" %in% names(params)) 
#&gt;                 data &lt;- cbind(data, rel_min_height = self$default_aes$rel_min_height)
#&gt;             else data &lt;- cbind(data, rel_min_height = params$rel_min_height)
#&gt;         }
#&gt;         data &lt;- transform(data, ymin = y, ymax = y + iscale * 
#&gt;             scale * height, min_height = hmax * rel_min_height)
#&gt;         return(data)
#&gt;     }
#&gt;     data
#&gt; } else {
#&gt;     subset(data, level == max(data$level))
#&gt; }
#&gt; debug: subset(data, level == max(data$level))

ggplot(mtcars) + geom_bloc(aes(height = c(P(gear|am)), width = c(P(cyl|gear, am)), 
                               y = c(am)))
#&gt;   marg    cond    aes level
#&gt; 1    1      am y.cond     1
#&gt; 2 gear      am height     2
#&gt; 3  cyl gear,am  width     3
#&gt; Aesthetic mapping: 
#&gt; * `y`      -&gt; 1
#&gt; * `p.cyl`  -&gt; `cyl`
#&gt; * `p.gear` -&gt; `gear`
#&gt; * `p.am`   -&gt; `am`
#&gt; * `x`      -&gt; 1
#&gt; Don't know how to automatically pick scale for object of type pgog. Defaulting to continuous.
#&gt; Don't know how to automatically pick scale for object of type pgog. Defaulting to continuous.
#&gt; Defaulting to mosaic plots. Use `stat=blocdensity` to force density plots
#&gt; Warning in max(wt, na.rm = TRUE): no non-missing arguments to max; returning -
#&gt; Inf

#&gt; Warning in max(wt, na.rm = TRUE): no non-missing arguments to max; returning -
#&gt; Inf</code></pre>
<p><img src="pgog_files/figure-html/unnamed-chunk-7-2.png" width="700"></p>
<pre><code>#&gt; Called from: f(..., self = self)
#&gt; debug: if ("density" %in% names(data)) {
#&gt;     data &lt;- transform(data[order(data$PANEL, data$group, data$x), 
#&gt;         ], ymin = 0, ymax = y)
#&gt;     if ("height" %in% names(data)) {
#&gt;         if (is.null(params$panel_scaling)) {
#&gt;             params$panel_scaling &lt;- TRUE
#&gt;         }
#&gt;         yrange = max(data$y) - min(data$y)
#&gt;         n = length(unique(data$y))
#&gt;         if (n &lt; 2) {
#&gt;             hmax &lt;- max(data$height, na.rm = TRUE)
#&gt;             iscale &lt;- 1
#&gt;         }
#&gt;         else {
#&gt;             if (params$panel_scaling) {
#&gt;                 heights &lt;- split(data$height, data$PANEL)
#&gt;                 max_heights &lt;- vapply(heights, max, numeric(1), 
#&gt;                   na.rm = TRUE)
#&gt;                 hmax &lt;- max_heights[data$PANEL]
#&gt;                 iscale &lt;- yrange/((n - 1) * hmax)
#&gt;             }
#&gt;             else {
#&gt;                 hmax &lt;- max(data$height, na.rm = TRUE)
#&gt;                 iscale &lt;- yrange/((n - 1) * hmax)
#&gt;             }
#&gt;         }
#&gt;         data &lt;- cbind(data, iscale)
#&gt;         if (!"scale" %in% names(data)) {
#&gt;             if (!"scale" %in% names(params)) 
#&gt;                 data &lt;- cbind(data, scale = self$default_aes$scale)
#&gt;             else data &lt;- cbind(data, scale = params$scale)
#&gt;         }
#&gt;         if (!"rel_min_height" %in% names(data)) {
#&gt;             if (!"rel_min_height" %in% names(params)) 
#&gt;                 data &lt;- cbind(data, rel_min_height = self$default_aes$rel_min_height)
#&gt;             else data &lt;- cbind(data, rel_min_height = params$rel_min_height)
#&gt;         }
#&gt;         data &lt;- transform(data, ymin = y, ymax = y + iscale * 
#&gt;             scale * height, min_height = hmax * rel_min_height)
#&gt;         return(data)
#&gt;     }
#&gt;     data
#&gt; } else {
#&gt;     subset(data, level == max(data$level))
#&gt; }
#&gt; debug: subset(data, level == max(data$level))


ggplot(mtcars) + geom_bloc(aes(height = c(P(gear), P(cyl|gear))))
#&gt;   marg cond    aes level
#&gt; 1 gear      height     1
#&gt; 2  cyl gear height     2
#&gt; Aesthetic mapping: 
#&gt; * `p.cyl`  -&gt; `cyl`
#&gt; * `p.gear` -&gt; `gear`
#&gt; * `x`      -&gt; 1
#&gt; * `y`      -&gt; 1
#&gt; Don't know how to automatically pick scale for object of type pgog. Defaulting to continuous.
#&gt; Don't know how to automatically pick scale for object of type pgog. Defaulting to continuous.
#&gt; Defaulting to mosaic plots. Use `stat=blocdensity` to force density plots</code></pre>
<p><img src="pgog_files/figure-html/unnamed-chunk-7-3.png" width="700"></p>
<pre><code>#&gt; Called from: f(..., self = self)
#&gt; debug: if ("density" %in% names(data)) {
#&gt;     data &lt;- transform(data[order(data$PANEL, data$group, data$x), 
#&gt;         ], ymin = 0, ymax = y)
#&gt;     if ("height" %in% names(data)) {
#&gt;         if (is.null(params$panel_scaling)) {
#&gt;             params$panel_scaling &lt;- TRUE
#&gt;         }
#&gt;         yrange = max(data$y) - min(data$y)
#&gt;         n = length(unique(data$y))
#&gt;         if (n &lt; 2) {
#&gt;             hmax &lt;- max(data$height, na.rm = TRUE)
#&gt;             iscale &lt;- 1
#&gt;         }
#&gt;         else {
#&gt;             if (params$panel_scaling) {
#&gt;                 heights &lt;- split(data$height, data$PANEL)
#&gt;                 max_heights &lt;- vapply(heights, max, numeric(1), 
#&gt;                   na.rm = TRUE)
#&gt;                 hmax &lt;- max_heights[data$PANEL]
#&gt;                 iscale &lt;- yrange/((n - 1) * hmax)
#&gt;             }
#&gt;             else {
#&gt;                 hmax &lt;- max(data$height, na.rm = TRUE)
#&gt;                 iscale &lt;- yrange/((n - 1) * hmax)
#&gt;             }
#&gt;         }
#&gt;         data &lt;- cbind(data, iscale)
#&gt;         if (!"scale" %in% names(data)) {
#&gt;             if (!"scale" %in% names(params)) 
#&gt;                 data &lt;- cbind(data, scale = self$default_aes$scale)
#&gt;             else data &lt;- cbind(data, scale = params$scale)
#&gt;         }
#&gt;         if (!"rel_min_height" %in% names(data)) {
#&gt;             if (!"rel_min_height" %in% names(params)) 
#&gt;                 data &lt;- cbind(data, rel_min_height = self$default_aes$rel_min_height)
#&gt;             else data &lt;- cbind(data, rel_min_height = params$rel_min_height)
#&gt;         }
#&gt;         data &lt;- transform(data, ymin = y, ymax = y + iscale * 
#&gt;             scale * height, min_height = hmax * rel_min_height)
#&gt;         return(data)
#&gt;     }
#&gt;     data
#&gt; } else {
#&gt;     subset(data, level == max(data$level))
#&gt; }
#&gt; debug: subset(data, level == max(data$level))</code></pre>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" data-line-number="1"><span class="kw">ggplot</span>(mtcars) <span class="op">+</span><span class="st"> </span><span class="kw">geom_bloc</span>(<span class="kw">aes</span>(<span class="dt">height =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="kw">P</span>(gear<span class="op">|</span>am), <span class="kw">P</span>(cyl<span class="op">|</span>gear, am)), <span class="dt">x =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(gear), <span class="dt">y =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(am)))</a>
<a class="sourceLine" id="cb16-2" data-line-number="2"><span class="co">#&gt;   marg    cond      aes level</span></a>
<a class="sourceLine" id="cb16-3" data-line-number="3"><span class="co">#&gt; 1    1      am   y.cond     1</span></a>
<a class="sourceLine" id="cb16-4" data-line-number="4"><span class="co">#&gt; 2 gear      am x.height     2</span></a>
<a class="sourceLine" id="cb16-5" data-line-number="5"><span class="co">#&gt; 3  cyl gear,am   height     3</span></a>
<a class="sourceLine" id="cb16-6" data-line-number="6"><span class="co">#&gt; Aesthetic mapping: </span></a>
<a class="sourceLine" id="cb16-7" data-line-number="7"><span class="co">#&gt; * `x`      -&gt; 1</span></a>
<a class="sourceLine" id="cb16-8" data-line-number="8"><span class="co">#&gt; * `y`      -&gt; 1</span></a>
<a class="sourceLine" id="cb16-9" data-line-number="9"><span class="co">#&gt; * `p.cyl`  -&gt; `cyl`</span></a>
<a class="sourceLine" id="cb16-10" data-line-number="10"><span class="co">#&gt; * `p.gear` -&gt; `gear`</span></a>
<a class="sourceLine" id="cb16-11" data-line-number="11"><span class="co">#&gt; * `p.am`   -&gt; `am`</span></a>
<a class="sourceLine" id="cb16-12" data-line-number="12"><span class="co">#&gt; Don't know how to automatically pick scale for object of type pgog. Defaulting to continuous.</span></a>
<a class="sourceLine" id="cb16-13" data-line-number="13"><span class="co">#&gt; Don't know how to automatically pick scale for object of type pgog. Defaulting to continuous.</span></a>
<a class="sourceLine" id="cb16-14" data-line-number="14"><span class="co">#&gt; Defaulting to mosaic plots. Use `stat=blocdensity` to force density plots</span></a>
<a class="sourceLine" id="cb16-15" data-line-number="15"><span class="co">#&gt; Warning in max(wt, na.rm = TRUE): no non-missing arguments to max; returning -</span></a>
<a class="sourceLine" id="cb16-16" data-line-number="16"><span class="co">#&gt; Inf</span></a>
<a class="sourceLine" id="cb16-17" data-line-number="17"></a>
<a class="sourceLine" id="cb16-18" data-line-number="18"><span class="co">#&gt; Warning in max(wt, na.rm = TRUE): no non-missing arguments to max; returning -</span></a>
<a class="sourceLine" id="cb16-19" data-line-number="19"><span class="co">#&gt; Inf</span></a></code></pre></div>
<p><img src="pgog_files/figure-html/unnamed-chunk-8-1.png" width="700"></p>
<pre><code>#&gt; Called from: f(..., self = self)
#&gt; debug: if ("density" %in% names(data)) {
#&gt;     data &lt;- transform(data[order(data$PANEL, data$group, data$x), 
#&gt;         ], ymin = 0, ymax = y)
#&gt;     if ("height" %in% names(data)) {
#&gt;         if (is.null(params$panel_scaling)) {
#&gt;             params$panel_scaling &lt;- TRUE
#&gt;         }
#&gt;         yrange = max(data$y) - min(data$y)
#&gt;         n = length(unique(data$y))
#&gt;         if (n &lt; 2) {
#&gt;             hmax &lt;- max(data$height, na.rm = TRUE)
#&gt;             iscale &lt;- 1
#&gt;         }
#&gt;         else {
#&gt;             if (params$panel_scaling) {
#&gt;                 heights &lt;- split(data$height, data$PANEL)
#&gt;                 max_heights &lt;- vapply(heights, max, numeric(1), 
#&gt;                   na.rm = TRUE)
#&gt;                 hmax &lt;- max_heights[data$PANEL]
#&gt;                 iscale &lt;- yrange/((n - 1) * hmax)
#&gt;             }
#&gt;             else {
#&gt;                 hmax &lt;- max(data$height, na.rm = TRUE)
#&gt;                 iscale &lt;- yrange/((n - 1) * hmax)
#&gt;             }
#&gt;         }
#&gt;         data &lt;- cbind(data, iscale)
#&gt;         if (!"scale" %in% names(data)) {
#&gt;             if (!"scale" %in% names(params)) 
#&gt;                 data &lt;- cbind(data, scale = self$default_aes$scale)
#&gt;             else data &lt;- cbind(data, scale = params$scale)
#&gt;         }
#&gt;         if (!"rel_min_height" %in% names(data)) {
#&gt;             if (!"rel_min_height" %in% names(params)) 
#&gt;                 data &lt;- cbind(data, rel_min_height = self$default_aes$rel_min_height)
#&gt;             else data &lt;- cbind(data, rel_min_height = params$rel_min_height)
#&gt;         }
#&gt;         data &lt;- transform(data, ymin = y, ymax = y + iscale * 
#&gt;             scale * height, min_height = hmax * rel_min_height)
#&gt;         return(data)
#&gt;     }
#&gt;     data
#&gt; } else {
#&gt;     subset(data, level == max(data$level))
#&gt; }
#&gt; debug: subset(data, level == max(data$level))</code></pre>
</div>
<div id="density-plots" class="section level2">
<h2 class="hasAnchor">
<a href="#density-plots" class="anchor"></a>density plots</h2>
<div id="pa" class="section level3">
<h3 class="hasAnchor">
<a href="#pa" class="anchor"></a>P(A|â€¦)</h3>
<p>x &lt;- A height &lt;- P(A)</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" data-line-number="1"><span class="kw">ggplot</span>(mtcars) <span class="op">+</span><span class="st">  </span><span class="kw">geom_bloc</span>(<span class="kw">aes</span>(<span class="dt">x =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(mpg), <span class="dt">height =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="kw">P</span>(mpg)))) </a>
<a class="sourceLine" id="cb18-2" data-line-number="2"><span class="co">#&gt;   marg cond      aes level</span></a>
<a class="sourceLine" id="cb18-3" data-line-number="3"><span class="co">#&gt; 1  mpg      x.height     1</span></a>
<a class="sourceLine" id="cb18-4" data-line-number="4"><span class="co">#&gt; Warning: Outer names are only allowed for unnamed scalar atomic inputs</span></a>
<a class="sourceLine" id="cb18-5" data-line-number="5"></a>
<a class="sourceLine" id="cb18-6" data-line-number="6"><span class="co">#&gt; Warning: Outer names are only allowed for unnamed scalar atomic inputs</span></a>
<a class="sourceLine" id="cb18-7" data-line-number="7"><span class="co">#&gt; Aesthetic mapping: </span></a>
<a class="sourceLine" id="cb18-8" data-line-number="8"><span class="co">#&gt; * `x`     -&gt; 1</span></a>
<a class="sourceLine" id="cb18-9" data-line-number="9"><span class="co">#&gt; * `p.mpg` -&gt; `mpg`</span></a>
<a class="sourceLine" id="cb18-10" data-line-number="10"><span class="co">#&gt; * `y`     -&gt; 1</span></a>
<a class="sourceLine" id="cb18-11" data-line-number="11"><span class="co">#&gt; Don't know how to automatically pick scale for object of type pgog. Defaulting to continuous.</span></a>
<a class="sourceLine" id="cb18-12" data-line-number="12"><span class="co">#&gt; Don't know how to automatically pick scale for object of type pgog. Defaulting to continuous.</span></a>
<a class="sourceLine" id="cb18-13" data-line-number="13"><span class="co">#&gt; Warning: Outer names are only allowed for unnamed scalar atomic inputs</span></a>
<a class="sourceLine" id="cb18-14" data-line-number="14"></a>
<a class="sourceLine" id="cb18-15" data-line-number="15"><span class="co">#&gt; Warning: Outer names are only allowed for unnamed scalar atomic inputs</span></a>
<a class="sourceLine" id="cb18-16" data-line-number="16"><span class="co">#&gt; Defaulting to density plots. Use `stat=mosaic` to force mosaic plots</span></a>
<a class="sourceLine" id="cb18-17" data-line-number="17"><span class="co">#&gt; Warning in if (!is.na(res$density)) {: the condition has length &gt; 1 and only the</span></a>
<a class="sourceLine" id="cb18-18" data-line-number="18"><span class="co">#&gt; first element will be used</span></a></code></pre></div>
<p><img src="pgog_files/figure-html/unnamed-chunk-9-1.png" width="700"></p>
<pre><code>#&gt; Called from: f(..., self = self)
#&gt; debug: if ("density" %in% names(data)) {
#&gt;     data &lt;- transform(data[order(data$PANEL, data$group, data$x), 
#&gt;         ], ymin = 0, ymax = y)
#&gt;     if ("height" %in% names(data)) {
#&gt;         if (is.null(params$panel_scaling)) {
#&gt;             params$panel_scaling &lt;- TRUE
#&gt;         }
#&gt;         yrange = max(data$y) - min(data$y)
#&gt;         n = length(unique(data$y))
#&gt;         if (n &lt; 2) {
#&gt;             hmax &lt;- max(data$height, na.rm = TRUE)
#&gt;             iscale &lt;- 1
#&gt;         }
#&gt;         else {
#&gt;             if (params$panel_scaling) {
#&gt;                 heights &lt;- split(data$height, data$PANEL)
#&gt;                 max_heights &lt;- vapply(heights, max, numeric(1), 
#&gt;                   na.rm = TRUE)
#&gt;                 hmax &lt;- max_heights[data$PANEL]
#&gt;                 iscale &lt;- yrange/((n - 1) * hmax)
#&gt;             }
#&gt;             else {
#&gt;                 hmax &lt;- max(data$height, na.rm = TRUE)
#&gt;                 iscale &lt;- yrange/((n - 1) * hmax)
#&gt;             }
#&gt;         }
#&gt;         data &lt;- cbind(data, iscale)
#&gt;         if (!"scale" %in% names(data)) {
#&gt;             if (!"scale" %in% names(params)) 
#&gt;                 data &lt;- cbind(data, scale = self$default_aes$scale)
#&gt;             else data &lt;- cbind(data, scale = params$scale)
#&gt;         }
#&gt;         if (!"rel_min_height" %in% names(data)) {
#&gt;             if (!"rel_min_height" %in% names(params)) 
#&gt;                 data &lt;- cbind(data, rel_min_height = self$default_aes$rel_min_height)
#&gt;             else data &lt;- cbind(data, rel_min_height = params$rel_min_height)
#&gt;         }
#&gt;         data &lt;- transform(data, ymin = y, ymax = y + iscale * 
#&gt;             scale * height, min_height = hmax * rel_min_height)
#&gt;         return(data)
#&gt;     }
#&gt;     data
#&gt; } else {
#&gt;     subset(data, level == max(data$level))
#&gt; }
#&gt; debug: data &lt;- transform(data[order(data$PANEL, data$group, data$x), 
#&gt;     ], ymin = 0, ymax = y)
#&gt; debug: if ("height" %in% names(data)) {
#&gt;     if (is.null(params$panel_scaling)) {
#&gt;         params$panel_scaling &lt;- TRUE
#&gt;     }
#&gt;     yrange = max(data$y) - min(data$y)
#&gt;     n = length(unique(data$y))
#&gt;     if (n &lt; 2) {
#&gt;         hmax &lt;- max(data$height, na.rm = TRUE)
#&gt;         iscale &lt;- 1
#&gt;     }
#&gt;     else {
#&gt;         if (params$panel_scaling) {
#&gt;             heights &lt;- split(data$height, data$PANEL)
#&gt;             max_heights &lt;- vapply(heights, max, numeric(1), na.rm = TRUE)
#&gt;             hmax &lt;- max_heights[data$PANEL]
#&gt;             iscale &lt;- yrange/((n - 1) * hmax)
#&gt;         }
#&gt;         else {
#&gt;             hmax &lt;- max(data$height, na.rm = TRUE)
#&gt;             iscale &lt;- yrange/((n - 1) * hmax)
#&gt;         }
#&gt;     }
#&gt;     data &lt;- cbind(data, iscale)
#&gt;     if (!"scale" %in% names(data)) {
#&gt;         if (!"scale" %in% names(params)) 
#&gt;             data &lt;- cbind(data, scale = self$default_aes$scale)
#&gt;         else data &lt;- cbind(data, scale = params$scale)
#&gt;     }
#&gt;     if (!"rel_min_height" %in% names(data)) {
#&gt;         if (!"rel_min_height" %in% names(params)) 
#&gt;             data &lt;- cbind(data, rel_min_height = self$default_aes$rel_min_height)
#&gt;         else data &lt;- cbind(data, rel_min_height = params$rel_min_height)
#&gt;     }
#&gt;     data &lt;- transform(data, ymin = y, ymax = y + iscale * scale * 
#&gt;         height, min_height = hmax * rel_min_height)
#&gt;     return(data)
#&gt; }
#&gt; debug: data</code></pre>
</div>
<div id="pab" class="section level3">
<h3 class="hasAnchor">
<a href="#pab" class="anchor"></a>P(A|B)</h3>
<p>TODO: this spec is wrong</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb20-1" data-line-number="1"><span class="kw">ggplot</span>(mtcars) <span class="op">+</span><span class="st"> </span><span class="kw">geom_bloc</span>(<span class="kw">aes</span>(<span class="dt">x =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(mpg, cyl), <span class="dt">height =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="kw">P</span>(mpg <span class="op">|</span><span class="st"> </span>cyl)), <span class="dt">colour =</span> <span class="kw"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(cyl)))</a>
<a class="sourceLine" id="cb20-2" data-line-number="2"><span class="co">#&gt;   marg cond      aes level</span></a>
<a class="sourceLine" id="cb20-3" data-line-number="3"><span class="co">#&gt; 1    1  cyl   x.cond     1</span></a>
<a class="sourceLine" id="cb20-4" data-line-number="4"><span class="co">#&gt; 2  mpg  cyl x.height     2</span></a>
<a class="sourceLine" id="cb20-5" data-line-number="5"><span class="co">#&gt; Warning: Outer names are only allowed for unnamed scalar atomic inputs</span></a>
<a class="sourceLine" id="cb20-6" data-line-number="6"></a>
<a class="sourceLine" id="cb20-7" data-line-number="7"><span class="co">#&gt; Warning: Outer names are only allowed for unnamed scalar atomic inputs</span></a>
<a class="sourceLine" id="cb20-8" data-line-number="8"></a>
<a class="sourceLine" id="cb20-9" data-line-number="9"><span class="co">#&gt; Warning: Outer names are only allowed for unnamed scalar atomic inputs</span></a>
<a class="sourceLine" id="cb20-10" data-line-number="10"><span class="co">#&gt; Aesthetic mapping: </span></a>
<a class="sourceLine" id="cb20-11" data-line-number="11"><span class="co">#&gt; * `x`      -&gt; 1</span></a>
<a class="sourceLine" id="cb20-12" data-line-number="12"><span class="co">#&gt; * `colour` -&gt; `factor(cyl)`</span></a>
<a class="sourceLine" id="cb20-13" data-line-number="13"><span class="co">#&gt; * `p.mpg`  -&gt; `mpg`</span></a>
<a class="sourceLine" id="cb20-14" data-line-number="14"><span class="co">#&gt; * `p.cyl`  -&gt; `cyl`</span></a>
<a class="sourceLine" id="cb20-15" data-line-number="15"><span class="co">#&gt; * `y`      -&gt; 1</span></a>
<a class="sourceLine" id="cb20-16" data-line-number="16"><span class="co">#&gt; Don't know how to automatically pick scale for object of type pgog. Defaulting to continuous.</span></a>
<a class="sourceLine" id="cb20-17" data-line-number="17"><span class="co">#&gt; Don't know how to automatically pick scale for object of type pgog. Defaulting to continuous.</span></a>
<a class="sourceLine" id="cb20-18" data-line-number="18"><span class="co">#&gt; Warning: Outer names are only allowed for unnamed scalar atomic inputs</span></a>
<a class="sourceLine" id="cb20-19" data-line-number="19"></a>
<a class="sourceLine" id="cb20-20" data-line-number="20"><span class="co">#&gt; Warning: Outer names are only allowed for unnamed scalar atomic inputs</span></a>
<a class="sourceLine" id="cb20-21" data-line-number="21"></a>
<a class="sourceLine" id="cb20-22" data-line-number="22"><span class="co">#&gt; Warning: Outer names are only allowed for unnamed scalar atomic inputs</span></a>
<a class="sourceLine" id="cb20-23" data-line-number="23"><span class="co">#&gt; Defaulting to density plots. Use `stat=mosaic` to force mosaic plots</span></a>
<a class="sourceLine" id="cb20-24" data-line-number="24"><span class="co">#&gt; Warning: Computation failed in `stat_bloc()`:</span></a>
<a class="sourceLine" id="cb20-25" data-line-number="25"><span class="co">#&gt; Check aes mapping on the categorial variable  p.cyl</span></a></code></pre></div>
<p><img src="pgog_files/figure-html/unnamed-chunk-10-1.png" width="700"></p>
<p>x &lt;- A color &lt;- B height &lt;- P(A|B)</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb21-1" data-line-number="1"><span class="kw">ggplot</span>(mtcars) <span class="op">+</span><span class="st"> </span><span class="kw">geom_bloc</span>(<span class="kw">aes</span>(</a>
<a class="sourceLine" id="cb21-2" data-line-number="2">    <span class="dt">x =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(mpg), </a>
<a class="sourceLine" id="cb21-3" data-line-number="3">   <span class="dt">height =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="kw">P</span>(mpg <span class="op">|</span><span class="st"> </span>cyl)), </a>
<a class="sourceLine" id="cb21-4" data-line-number="4">   <span class="dt">fill =</span> <span class="kw"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(cyl)))  <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb21-5" data-line-number="5"><span class="st">  </span><span class="kw">scale_fill_brewer</span>(<span class="dt">palette =</span> <span class="st">"Accent"</span>) <span class="op">+</span><span class="st"> </span><span class="kw">theme_minimal</span>()</a>
<a class="sourceLine" id="cb21-6" data-line-number="6"><span class="co">#&gt;   marg cond      aes level</span></a>
<a class="sourceLine" id="cb21-7" data-line-number="7"><span class="co">#&gt; 1    1  cyl     cond     1</span></a>
<a class="sourceLine" id="cb21-8" data-line-number="8"><span class="co">#&gt; 2  mpg  cyl x.height     2</span></a>
<a class="sourceLine" id="cb21-9" data-line-number="9"><span class="co">#&gt; Warning: Outer names are only allowed for unnamed scalar atomic inputs</span></a>
<a class="sourceLine" id="cb21-10" data-line-number="10"></a>
<a class="sourceLine" id="cb21-11" data-line-number="11"><span class="co">#&gt; Warning: Outer names are only allowed for unnamed scalar atomic inputs</span></a>
<a class="sourceLine" id="cb21-12" data-line-number="12"></a>
<a class="sourceLine" id="cb21-13" data-line-number="13"><span class="co">#&gt; Warning: Outer names are only allowed for unnamed scalar atomic inputs</span></a>
<a class="sourceLine" id="cb21-14" data-line-number="14"><span class="co">#&gt; Aesthetic mapping: </span></a>
<a class="sourceLine" id="cb21-15" data-line-number="15"><span class="co">#&gt; * `x`     -&gt; 1</span></a>
<a class="sourceLine" id="cb21-16" data-line-number="16"><span class="co">#&gt; * `fill`  -&gt; `factor(cyl)`</span></a>
<a class="sourceLine" id="cb21-17" data-line-number="17"><span class="co">#&gt; * `p.mpg` -&gt; `mpg`</span></a>
<a class="sourceLine" id="cb21-18" data-line-number="18"><span class="co">#&gt; * `p.cyl` -&gt; `cyl`</span></a>
<a class="sourceLine" id="cb21-19" data-line-number="19"><span class="co">#&gt; * `y`     -&gt; 1</span></a>
<a class="sourceLine" id="cb21-20" data-line-number="20"><span class="co">#&gt; Don't know how to automatically pick scale for object of type pgog. Defaulting to continuous.</span></a>
<a class="sourceLine" id="cb21-21" data-line-number="21"><span class="co">#&gt; Don't know how to automatically pick scale for object of type pgog. Defaulting to continuous.</span></a>
<a class="sourceLine" id="cb21-22" data-line-number="22"><span class="co">#&gt; Warning: Outer names are only allowed for unnamed scalar atomic inputs</span></a>
<a class="sourceLine" id="cb21-23" data-line-number="23"></a>
<a class="sourceLine" id="cb21-24" data-line-number="24"><span class="co">#&gt; Warning: Outer names are only allowed for unnamed scalar atomic inputs</span></a>
<a class="sourceLine" id="cb21-25" data-line-number="25"></a>
<a class="sourceLine" id="cb21-26" data-line-number="26"><span class="co">#&gt; Warning: Outer names are only allowed for unnamed scalar atomic inputs</span></a>
<a class="sourceLine" id="cb21-27" data-line-number="27"><span class="co">#&gt; Defaulting to density plots. Use `stat=mosaic` to force mosaic plots</span></a>
<a class="sourceLine" id="cb21-28" data-line-number="28"><span class="co">#&gt; Warning in if (!is.na(res$density)) {: the condition has length &gt; 1 and only the</span></a>
<a class="sourceLine" id="cb21-29" data-line-number="29"><span class="co">#&gt; first element will be used</span></a>
<a class="sourceLine" id="cb21-30" data-line-number="30"><span class="co">#&gt; Warning in if (!is.na(res$density)) {: the condition has length &gt; 1 and only the</span></a>
<a class="sourceLine" id="cb21-31" data-line-number="31"><span class="co">#&gt; first element will be used</span></a>
<a class="sourceLine" id="cb21-32" data-line-number="32"></a>
<a class="sourceLine" id="cb21-33" data-line-number="33"><span class="co">#&gt; Warning in if (!is.na(res$density)) {: the condition has length &gt; 1 and only the</span></a>
<a class="sourceLine" id="cb21-34" data-line-number="34"><span class="co">#&gt; first element will be used</span></a></code></pre></div>
<p><img src="pgog_files/figure-html/unnamed-chunk-11-1.png" width="700"></p>
<pre><code>#&gt; Called from: f(..., self = self)
#&gt; debug: if ("density" %in% names(data)) {
#&gt;     data &lt;- transform(data[order(data$PANEL, data$group, data$x), 
#&gt;         ], ymin = 0, ymax = y)
#&gt;     if ("height" %in% names(data)) {
#&gt;         if (is.null(params$panel_scaling)) {
#&gt;             params$panel_scaling &lt;- TRUE
#&gt;         }
#&gt;         yrange = max(data$y) - min(data$y)
#&gt;         n = length(unique(data$y))
#&gt;         if (n &lt; 2) {
#&gt;             hmax &lt;- max(data$height, na.rm = TRUE)
#&gt;             iscale &lt;- 1
#&gt;         }
#&gt;         else {
#&gt;             if (params$panel_scaling) {
#&gt;                 heights &lt;- split(data$height, data$PANEL)
#&gt;                 max_heights &lt;- vapply(heights, max, numeric(1), 
#&gt;                   na.rm = TRUE)
#&gt;                 hmax &lt;- max_heights[data$PANEL]
#&gt;                 iscale &lt;- yrange/((n - 1) * hmax)
#&gt;             }
#&gt;             else {
#&gt;                 hmax &lt;- max(data$height, na.rm = TRUE)
#&gt;                 iscale &lt;- yrange/((n - 1) * hmax)
#&gt;             }
#&gt;         }
#&gt;         data &lt;- cbind(data, iscale)
#&gt;         if (!"scale" %in% names(data)) {
#&gt;             if (!"scale" %in% names(params)) 
#&gt;                 data &lt;- cbind(data, scale = self$default_aes$scale)
#&gt;             else data &lt;- cbind(data, scale = params$scale)
#&gt;         }
#&gt;         if (!"rel_min_height" %in% names(data)) {
#&gt;             if (!"rel_min_height" %in% names(params)) 
#&gt;                 data &lt;- cbind(data, rel_min_height = self$default_aes$rel_min_height)
#&gt;             else data &lt;- cbind(data, rel_min_height = params$rel_min_height)
#&gt;         }
#&gt;         data &lt;- transform(data, ymin = y, ymax = y + iscale * 
#&gt;             scale * height, min_height = hmax * rel_min_height)
#&gt;         return(data)
#&gt;     }
#&gt;     data
#&gt; } else {
#&gt;     subset(data, level == max(data$level))
#&gt; }
#&gt; debug: data &lt;- transform(data[order(data$PANEL, data$group, data$x), 
#&gt;     ], ymin = 0, ymax = y)
#&gt; debug: if ("height" %in% names(data)) {
#&gt;     if (is.null(params$panel_scaling)) {
#&gt;         params$panel_scaling &lt;- TRUE
#&gt;     }
#&gt;     yrange = max(data$y) - min(data$y)
#&gt;     n = length(unique(data$y))
#&gt;     if (n &lt; 2) {
#&gt;         hmax &lt;- max(data$height, na.rm = TRUE)
#&gt;         iscale &lt;- 1
#&gt;     }
#&gt;     else {
#&gt;         if (params$panel_scaling) {
#&gt;             heights &lt;- split(data$height, data$PANEL)
#&gt;             max_heights &lt;- vapply(heights, max, numeric(1), na.rm = TRUE)
#&gt;             hmax &lt;- max_heights[data$PANEL]
#&gt;             iscale &lt;- yrange/((n - 1) * hmax)
#&gt;         }
#&gt;         else {
#&gt;             hmax &lt;- max(data$height, na.rm = TRUE)
#&gt;             iscale &lt;- yrange/((n - 1) * hmax)
#&gt;         }
#&gt;     }
#&gt;     data &lt;- cbind(data, iscale)
#&gt;     if (!"scale" %in% names(data)) {
#&gt;         if (!"scale" %in% names(params)) 
#&gt;             data &lt;- cbind(data, scale = self$default_aes$scale)
#&gt;         else data &lt;- cbind(data, scale = params$scale)
#&gt;     }
#&gt;     if (!"rel_min_height" %in% names(data)) {
#&gt;         if (!"rel_min_height" %in% names(params)) 
#&gt;             data &lt;- cbind(data, rel_min_height = self$default_aes$rel_min_height)
#&gt;         else data &lt;- cbind(data, rel_min_height = params$rel_min_height)
#&gt;     }
#&gt;     data &lt;- transform(data, ymin = y, ymax = y + iscale * scale * 
#&gt;         height, min_height = hmax * rel_min_height)
#&gt;     return(data)
#&gt; }
#&gt; debug: data</code></pre>
</div>
<div id="ridge-plots" class="section level3">
<h3 class="hasAnchor">
<a href="#ridge-plots" class="anchor"></a>Ridge plots</h3>
<p>x &lt;- A y &lt;- B height &lt;- P(A|B)</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb23-1" data-line-number="1"><span class="kw">ggplot</span>(mtcars) <span class="op">+</span><span class="st"> </span><span class="kw">geom_bloc</span>(<span class="kw">aes</span>(<span class="dt">x =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(mpg), <span class="dt">height =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="kw">P</span>(mpg <span class="op">|</span><span class="st"> </span>cyl)), <span class="dt">y =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(cyl)))</a>
<a class="sourceLine" id="cb23-2" data-line-number="2"><span class="co">#&gt;   marg cond      aes level</span></a>
<a class="sourceLine" id="cb23-3" data-line-number="3"><span class="co">#&gt; 1    1  cyl   y.cond     1</span></a>
<a class="sourceLine" id="cb23-4" data-line-number="4"><span class="co">#&gt; 2  mpg  cyl x.height     2</span></a>
<a class="sourceLine" id="cb23-5" data-line-number="5"><span class="co">#&gt; Warning: Outer names are only allowed for unnamed scalar atomic inputs</span></a>
<a class="sourceLine" id="cb23-6" data-line-number="6"></a>
<a class="sourceLine" id="cb23-7" data-line-number="7"><span class="co">#&gt; Warning: Outer names are only allowed for unnamed scalar atomic inputs</span></a>
<a class="sourceLine" id="cb23-8" data-line-number="8"></a>
<a class="sourceLine" id="cb23-9" data-line-number="9"><span class="co">#&gt; Warning: Outer names are only allowed for unnamed scalar atomic inputs</span></a>
<a class="sourceLine" id="cb23-10" data-line-number="10"><span class="co">#&gt; Aesthetic mapping: </span></a>
<a class="sourceLine" id="cb23-11" data-line-number="11"><span class="co">#&gt; * `x`     -&gt; 1</span></a>
<a class="sourceLine" id="cb23-12" data-line-number="12"><span class="co">#&gt; * `y`     -&gt; 1</span></a>
<a class="sourceLine" id="cb23-13" data-line-number="13"><span class="co">#&gt; * `p.mpg` -&gt; `mpg`</span></a>
<a class="sourceLine" id="cb23-14" data-line-number="14"><span class="co">#&gt; * `p.cyl` -&gt; `cyl`</span></a>
<a class="sourceLine" id="cb23-15" data-line-number="15"><span class="co">#&gt; Don't know how to automatically pick scale for object of type pgog. Defaulting to continuous.</span></a>
<a class="sourceLine" id="cb23-16" data-line-number="16"><span class="co">#&gt; Don't know how to automatically pick scale for object of type pgog. Defaulting to continuous.</span></a>
<a class="sourceLine" id="cb23-17" data-line-number="17"><span class="co">#&gt; Warning: Outer names are only allowed for unnamed scalar atomic inputs</span></a>
<a class="sourceLine" id="cb23-18" data-line-number="18"></a>
<a class="sourceLine" id="cb23-19" data-line-number="19"><span class="co">#&gt; Warning: Outer names are only allowed for unnamed scalar atomic inputs</span></a>
<a class="sourceLine" id="cb23-20" data-line-number="20"></a>
<a class="sourceLine" id="cb23-21" data-line-number="21"><span class="co">#&gt; Warning: Outer names are only allowed for unnamed scalar atomic inputs</span></a>
<a class="sourceLine" id="cb23-22" data-line-number="22"><span class="co">#&gt; Defaulting to density plots. Use `stat=mosaic` to force mosaic plots</span></a>
<a class="sourceLine" id="cb23-23" data-line-number="23"><span class="co">#&gt; Warning in if (!is.na(res$density)) {: the condition has length &gt; 1 and only the</span></a>
<a class="sourceLine" id="cb23-24" data-line-number="24"><span class="co">#&gt; first element will be used</span></a>
<a class="sourceLine" id="cb23-25" data-line-number="25"><span class="co">#&gt; Warning in if (!is.na(res$density)) {: the condition has length &gt; 1 and only the</span></a>
<a class="sourceLine" id="cb23-26" data-line-number="26"><span class="co">#&gt; first element will be used</span></a>
<a class="sourceLine" id="cb23-27" data-line-number="27"></a>
<a class="sourceLine" id="cb23-28" data-line-number="28"><span class="co">#&gt; Warning in if (!is.na(res$density)) {: the condition has length &gt; 1 and only the</span></a>
<a class="sourceLine" id="cb23-29" data-line-number="29"><span class="co">#&gt; first element will be used</span></a></code></pre></div>
<p><img src="pgog_files/figure-html/unnamed-chunk-12-1.png" width="700"></p>
<pre><code>#&gt; Called from: f(..., self = self)
#&gt; debug: if ("density" %in% names(data)) {
#&gt;     data &lt;- transform(data[order(data$PANEL, data$group, data$x), 
#&gt;         ], ymin = 0, ymax = y)
#&gt;     if ("height" %in% names(data)) {
#&gt;         if (is.null(params$panel_scaling)) {
#&gt;             params$panel_scaling &lt;- TRUE
#&gt;         }
#&gt;         yrange = max(data$y) - min(data$y)
#&gt;         n = length(unique(data$y))
#&gt;         if (n &lt; 2) {
#&gt;             hmax &lt;- max(data$height, na.rm = TRUE)
#&gt;             iscale &lt;- 1
#&gt;         }
#&gt;         else {
#&gt;             if (params$panel_scaling) {
#&gt;                 heights &lt;- split(data$height, data$PANEL)
#&gt;                 max_heights &lt;- vapply(heights, max, numeric(1), 
#&gt;                   na.rm = TRUE)
#&gt;                 hmax &lt;- max_heights[data$PANEL]
#&gt;                 iscale &lt;- yrange/((n - 1) * hmax)
#&gt;             }
#&gt;             else {
#&gt;                 hmax &lt;- max(data$height, na.rm = TRUE)
#&gt;                 iscale &lt;- yrange/((n - 1) * hmax)
#&gt;             }
#&gt;         }
#&gt;         data &lt;- cbind(data, iscale)
#&gt;         if (!"scale" %in% names(data)) {
#&gt;             if (!"scale" %in% names(params)) 
#&gt;                 data &lt;- cbind(data, scale = self$default_aes$scale)
#&gt;             else data &lt;- cbind(data, scale = params$scale)
#&gt;         }
#&gt;         if (!"rel_min_height" %in% names(data)) {
#&gt;             if (!"rel_min_height" %in% names(params)) 
#&gt;                 data &lt;- cbind(data, rel_min_height = self$default_aes$rel_min_height)
#&gt;             else data &lt;- cbind(data, rel_min_height = params$rel_min_height)
#&gt;         }
#&gt;         data &lt;- transform(data, ymin = y, ymax = y + iscale * 
#&gt;             scale * height, min_height = hmax * rel_min_height)
#&gt;         return(data)
#&gt;     }
#&gt;     data
#&gt; } else {
#&gt;     subset(data, level == max(data$level))
#&gt; }
#&gt; debug: data &lt;- transform(data[order(data$PANEL, data$group, data$x), 
#&gt;     ], ymin = 0, ymax = y)
#&gt; debug: if ("height" %in% names(data)) {
#&gt;     if (is.null(params$panel_scaling)) {
#&gt;         params$panel_scaling &lt;- TRUE
#&gt;     }
#&gt;     yrange = max(data$y) - min(data$y)
#&gt;     n = length(unique(data$y))
#&gt;     if (n &lt; 2) {
#&gt;         hmax &lt;- max(data$height, na.rm = TRUE)
#&gt;         iscale &lt;- 1
#&gt;     }
#&gt;     else {
#&gt;         if (params$panel_scaling) {
#&gt;             heights &lt;- split(data$height, data$PANEL)
#&gt;             max_heights &lt;- vapply(heights, max, numeric(1), na.rm = TRUE)
#&gt;             hmax &lt;- max_heights[data$PANEL]
#&gt;             iscale &lt;- yrange/((n - 1) * hmax)
#&gt;         }
#&gt;         else {
#&gt;             hmax &lt;- max(data$height, na.rm = TRUE)
#&gt;             iscale &lt;- yrange/((n - 1) * hmax)
#&gt;         }
#&gt;     }
#&gt;     data &lt;- cbind(data, iscale)
#&gt;     if (!"scale" %in% names(data)) {
#&gt;         if (!"scale" %in% names(params)) 
#&gt;             data &lt;- cbind(data, scale = self$default_aes$scale)
#&gt;         else data &lt;- cbind(data, scale = params$scale)
#&gt;     }
#&gt;     if (!"rel_min_height" %in% names(data)) {
#&gt;         if (!"rel_min_height" %in% names(params)) 
#&gt;             data &lt;- cbind(data, rel_min_height = self$default_aes$rel_min_height)
#&gt;         else data &lt;- cbind(data, rel_min_height = params$rel_min_height)
#&gt;     }
#&gt;     data &lt;- transform(data, ymin = y, ymax = y + iscale * scale * 
#&gt;         height, min_height = hmax * rel_min_height)
#&gt;     return(data)
#&gt; }
#&gt; debug: if (is.null(params$panel_scaling)) {
#&gt;     params$panel_scaling &lt;- TRUE
#&gt; }
#&gt; debug: params$panel_scaling &lt;- TRUE
#&gt; debug: yrange = max(data$y) - min(data$y)
#&gt; debug: n = length(unique(data$y))
#&gt; debug: if (n &lt; 2) {
#&gt;     hmax &lt;- max(data$height, na.rm = TRUE)
#&gt;     iscale &lt;- 1
#&gt; } else {
#&gt;     if (params$panel_scaling) {
#&gt;         heights &lt;- split(data$height, data$PANEL)
#&gt;         max_heights &lt;- vapply(heights, max, numeric(1), na.rm = TRUE)
#&gt;         hmax &lt;- max_heights[data$PANEL]
#&gt;         iscale &lt;- yrange/((n - 1) * hmax)
#&gt;     }
#&gt;     else {
#&gt;         hmax &lt;- max(data$height, na.rm = TRUE)
#&gt;         iscale &lt;- yrange/((n - 1) * hmax)
#&gt;     }
#&gt; }
#&gt; debug: if (params$panel_scaling) {
#&gt;     heights &lt;- split(data$height, data$PANEL)
#&gt;     max_heights &lt;- vapply(heights, max, numeric(1), na.rm = TRUE)
#&gt;     hmax &lt;- max_heights[data$PANEL]
#&gt;     iscale &lt;- yrange/((n - 1) * hmax)
#&gt; } else {
#&gt;     hmax &lt;- max(data$height, na.rm = TRUE)
#&gt;     iscale &lt;- yrange/((n - 1) * hmax)
#&gt; }
#&gt; debug: heights &lt;- split(data$height, data$PANEL)
#&gt; debug: max_heights &lt;- vapply(heights, max, numeric(1), na.rm = TRUE)
#&gt; debug: hmax &lt;- max_heights[data$PANEL]
#&gt; debug: iscale &lt;- yrange/((n - 1) * hmax)
#&gt; debug: data &lt;- cbind(data, iscale)
#&gt; debug: if (!"scale" %in% names(data)) {
#&gt;     if (!"scale" %in% names(params)) 
#&gt;         data &lt;- cbind(data, scale = self$default_aes$scale)
#&gt;     else data &lt;- cbind(data, scale = params$scale)
#&gt; }
#&gt; debug: if (!"scale" %in% names(params)) data &lt;- cbind(data, scale = self$default_aes$scale) else data &lt;- cbind(data, 
#&gt;     scale = params$scale)
#&gt; debug: data &lt;- cbind(data, scale = self$default_aes$scale)
#&gt; debug: if (!"rel_min_height" %in% names(data)) {
#&gt;     if (!"rel_min_height" %in% names(params)) 
#&gt;         data &lt;- cbind(data, rel_min_height = self$default_aes$rel_min_height)
#&gt;     else data &lt;- cbind(data, rel_min_height = params$rel_min_height)
#&gt; }
#&gt; debug: if (!"rel_min_height" %in% names(params)) data &lt;- cbind(data, 
#&gt;     rel_min_height = self$default_aes$rel_min_height) else data &lt;- cbind(data, 
#&gt;     rel_min_height = params$rel_min_height)
#&gt; debug: data &lt;- cbind(data, rel_min_height = self$default_aes$rel_min_height)
#&gt; debug: data &lt;- transform(data, ymin = y, ymax = y + iscale * scale * 
#&gt;     height, min_height = hmax * rel_min_height)
#&gt; debug: return(data)</code></pre>
<p>x &lt;- A y &lt;- B color &lt;- B height &lt;- P(A|B)</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb25-1" data-line-number="1"><span class="kw">ggplot</span>(mtcars) <span class="op">+</span><span class="st"> </span><span class="kw">geom_bloc</span>(<span class="kw">aes</span>(</a>
<a class="sourceLine" id="cb25-2" data-line-number="2">  <span class="dt">x =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(mpg), </a>
<a class="sourceLine" id="cb25-3" data-line-number="3">  <span class="dt">y =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(cyl),</a>
<a class="sourceLine" id="cb25-4" data-line-number="4">  <span class="dt">height =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="kw">P</span>(mpg <span class="op">|</span><span class="st"> </span>cyl)),  </a>
<a class="sourceLine" id="cb25-5" data-line-number="5">  <span class="dt">color =</span> <span class="kw"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(cyl)</a>
<a class="sourceLine" id="cb25-6" data-line-number="6">))</a>
<a class="sourceLine" id="cb25-7" data-line-number="7"><span class="co">#&gt;   marg cond      aes level</span></a>
<a class="sourceLine" id="cb25-8" data-line-number="8"><span class="co">#&gt; 1    1  cyl   y.cond     1</span></a>
<a class="sourceLine" id="cb25-9" data-line-number="9"><span class="co">#&gt; 2  mpg  cyl x.height     2</span></a>
<a class="sourceLine" id="cb25-10" data-line-number="10"><span class="co">#&gt; Warning: Outer names are only allowed for unnamed scalar atomic inputs</span></a>
<a class="sourceLine" id="cb25-11" data-line-number="11"></a>
<a class="sourceLine" id="cb25-12" data-line-number="12"><span class="co">#&gt; Warning: Outer names are only allowed for unnamed scalar atomic inputs</span></a>
<a class="sourceLine" id="cb25-13" data-line-number="13"></a>
<a class="sourceLine" id="cb25-14" data-line-number="14"><span class="co">#&gt; Warning: Outer names are only allowed for unnamed scalar atomic inputs</span></a>
<a class="sourceLine" id="cb25-15" data-line-number="15"><span class="co">#&gt; Aesthetic mapping: </span></a>
<a class="sourceLine" id="cb25-16" data-line-number="16"><span class="co">#&gt; * `x`      -&gt; 1</span></a>
<a class="sourceLine" id="cb25-17" data-line-number="17"><span class="co">#&gt; * `y`      -&gt; 1</span></a>
<a class="sourceLine" id="cb25-18" data-line-number="18"><span class="co">#&gt; * `colour` -&gt; `factor(cyl)`</span></a>
<a class="sourceLine" id="cb25-19" data-line-number="19"><span class="co">#&gt; * `p.mpg`  -&gt; `mpg`</span></a>
<a class="sourceLine" id="cb25-20" data-line-number="20"><span class="co">#&gt; * `p.cyl`  -&gt; `cyl`</span></a>
<a class="sourceLine" id="cb25-21" data-line-number="21"><span class="co">#&gt; Don't know how to automatically pick scale for object of type pgog. Defaulting to continuous.</span></a>
<a class="sourceLine" id="cb25-22" data-line-number="22"><span class="co">#&gt; Don't know how to automatically pick scale for object of type pgog. Defaulting to continuous.</span></a>
<a class="sourceLine" id="cb25-23" data-line-number="23"><span class="co">#&gt; Warning: Outer names are only allowed for unnamed scalar atomic inputs</span></a>
<a class="sourceLine" id="cb25-24" data-line-number="24"></a>
<a class="sourceLine" id="cb25-25" data-line-number="25"><span class="co">#&gt; Warning: Outer names are only allowed for unnamed scalar atomic inputs</span></a>
<a class="sourceLine" id="cb25-26" data-line-number="26"></a>
<a class="sourceLine" id="cb25-27" data-line-number="27"><span class="co">#&gt; Warning: Outer names are only allowed for unnamed scalar atomic inputs</span></a>
<a class="sourceLine" id="cb25-28" data-line-number="28"><span class="co">#&gt; Defaulting to density plots. Use `stat=mosaic` to force mosaic plots</span></a>
<a class="sourceLine" id="cb25-29" data-line-number="29"><span class="co">#&gt; Warning in if (!is.na(res$density)) {: the condition has length &gt; 1 and only the</span></a>
<a class="sourceLine" id="cb25-30" data-line-number="30"><span class="co">#&gt; first element will be used</span></a>
<a class="sourceLine" id="cb25-31" data-line-number="31"><span class="co">#&gt; Warning in if (!is.na(res$density)) {: the condition has length &gt; 1 and only the</span></a>
<a class="sourceLine" id="cb25-32" data-line-number="32"><span class="co">#&gt; first element will be used</span></a>
<a class="sourceLine" id="cb25-33" data-line-number="33"></a>
<a class="sourceLine" id="cb25-34" data-line-number="34"><span class="co">#&gt; Warning in if (!is.na(res$density)) {: the condition has length &gt; 1 and only the</span></a>
<a class="sourceLine" id="cb25-35" data-line-number="35"><span class="co">#&gt; first element will be used</span></a></code></pre></div>
<p><img src="pgog_files/figure-html/unnamed-chunk-13-1.png" width="700"></p>
<pre><code>#&gt; Called from: f(..., self = self)
#&gt; debug: if ("density" %in% names(data)) {
#&gt;     data &lt;- transform(data[order(data$PANEL, data$group, data$x), 
#&gt;         ], ymin = 0, ymax = y)
#&gt;     if ("height" %in% names(data)) {
#&gt;         if (is.null(params$panel_scaling)) {
#&gt;             params$panel_scaling &lt;- TRUE
#&gt;         }
#&gt;         yrange = max(data$y) - min(data$y)
#&gt;         n = length(unique(data$y))
#&gt;         if (n &lt; 2) {
#&gt;             hmax &lt;- max(data$height, na.rm = TRUE)
#&gt;             iscale &lt;- 1
#&gt;         }
#&gt;         else {
#&gt;             if (params$panel_scaling) {
#&gt;                 heights &lt;- split(data$height, data$PANEL)
#&gt;                 max_heights &lt;- vapply(heights, max, numeric(1), 
#&gt;                   na.rm = TRUE)
#&gt;                 hmax &lt;- max_heights[data$PANEL]
#&gt;                 iscale &lt;- yrange/((n - 1) * hmax)
#&gt;             }
#&gt;             else {
#&gt;                 hmax &lt;- max(data$height, na.rm = TRUE)
#&gt;                 iscale &lt;- yrange/((n - 1) * hmax)
#&gt;             }
#&gt;         }
#&gt;         data &lt;- cbind(data, iscale)
#&gt;         if (!"scale" %in% names(data)) {
#&gt;             if (!"scale" %in% names(params)) 
#&gt;                 data &lt;- cbind(data, scale = self$default_aes$scale)
#&gt;             else data &lt;- cbind(data, scale = params$scale)
#&gt;         }
#&gt;         if (!"rel_min_height" %in% names(data)) {
#&gt;             if (!"rel_min_height" %in% names(params)) 
#&gt;                 data &lt;- cbind(data, rel_min_height = self$default_aes$rel_min_height)
#&gt;             else data &lt;- cbind(data, rel_min_height = params$rel_min_height)
#&gt;         }
#&gt;         data &lt;- transform(data, ymin = y, ymax = y + iscale * 
#&gt;             scale * height, min_height = hmax * rel_min_height)
#&gt;         return(data)
#&gt;     }
#&gt;     data
#&gt; } else {
#&gt;     subset(data, level == max(data$level))
#&gt; }
#&gt; debug: data &lt;- transform(data[order(data$PANEL, data$group, data$x), 
#&gt;     ], ymin = 0, ymax = y)
#&gt; debug: if ("height" %in% names(data)) {
#&gt;     if (is.null(params$panel_scaling)) {
#&gt;         params$panel_scaling &lt;- TRUE
#&gt;     }
#&gt;     yrange = max(data$y) - min(data$y)
#&gt;     n = length(unique(data$y))
#&gt;     if (n &lt; 2) {
#&gt;         hmax &lt;- max(data$height, na.rm = TRUE)
#&gt;         iscale &lt;- 1
#&gt;     }
#&gt;     else {
#&gt;         if (params$panel_scaling) {
#&gt;             heights &lt;- split(data$height, data$PANEL)
#&gt;             max_heights &lt;- vapply(heights, max, numeric(1), na.rm = TRUE)
#&gt;             hmax &lt;- max_heights[data$PANEL]
#&gt;             iscale &lt;- yrange/((n - 1) * hmax)
#&gt;         }
#&gt;         else {
#&gt;             hmax &lt;- max(data$height, na.rm = TRUE)
#&gt;             iscale &lt;- yrange/((n - 1) * hmax)
#&gt;         }
#&gt;     }
#&gt;     data &lt;- cbind(data, iscale)
#&gt;     if (!"scale" %in% names(data)) {
#&gt;         if (!"scale" %in% names(params)) 
#&gt;             data &lt;- cbind(data, scale = self$default_aes$scale)
#&gt;         else data &lt;- cbind(data, scale = params$scale)
#&gt;     }
#&gt;     if (!"rel_min_height" %in% names(data)) {
#&gt;         if (!"rel_min_height" %in% names(params)) 
#&gt;             data &lt;- cbind(data, rel_min_height = self$default_aes$rel_min_height)
#&gt;         else data &lt;- cbind(data, rel_min_height = params$rel_min_height)
#&gt;     }
#&gt;     data &lt;- transform(data, ymin = y, ymax = y + iscale * scale * 
#&gt;         height, min_height = hmax * rel_min_height)
#&gt;     return(data)
#&gt; }
#&gt; debug: if (is.null(params$panel_scaling)) {
#&gt;     params$panel_scaling &lt;- TRUE
#&gt; }
#&gt; debug: params$panel_scaling &lt;- TRUE
#&gt; debug: yrange = max(data$y) - min(data$y)
#&gt; debug: n = length(unique(data$y))
#&gt; debug: if (n &lt; 2) {
#&gt;     hmax &lt;- max(data$height, na.rm = TRUE)
#&gt;     iscale &lt;- 1
#&gt; } else {
#&gt;     if (params$panel_scaling) {
#&gt;         heights &lt;- split(data$height, data$PANEL)
#&gt;         max_heights &lt;- vapply(heights, max, numeric(1), na.rm = TRUE)
#&gt;         hmax &lt;- max_heights[data$PANEL]
#&gt;         iscale &lt;- yrange/((n - 1) * hmax)
#&gt;     }
#&gt;     else {
#&gt;         hmax &lt;- max(data$height, na.rm = TRUE)
#&gt;         iscale &lt;- yrange/((n - 1) * hmax)
#&gt;     }
#&gt; }
#&gt; debug: if (params$panel_scaling) {
#&gt;     heights &lt;- split(data$height, data$PANEL)
#&gt;     max_heights &lt;- vapply(heights, max, numeric(1), na.rm = TRUE)
#&gt;     hmax &lt;- max_heights[data$PANEL]
#&gt;     iscale &lt;- yrange/((n - 1) * hmax)
#&gt; } else {
#&gt;     hmax &lt;- max(data$height, na.rm = TRUE)
#&gt;     iscale &lt;- yrange/((n - 1) * hmax)
#&gt; }
#&gt; debug: heights &lt;- split(data$height, data$PANEL)
#&gt; debug: max_heights &lt;- vapply(heights, max, numeric(1), na.rm = TRUE)
#&gt; debug: hmax &lt;- max_heights[data$PANEL]
#&gt; debug: iscale &lt;- yrange/((n - 1) * hmax)
#&gt; debug: data &lt;- cbind(data, iscale)
#&gt; debug: if (!"scale" %in% names(data)) {
#&gt;     if (!"scale" %in% names(params)) 
#&gt;         data &lt;- cbind(data, scale = self$default_aes$scale)
#&gt;     else data &lt;- cbind(data, scale = params$scale)
#&gt; }
#&gt; debug: if (!"scale" %in% names(params)) data &lt;- cbind(data, scale = self$default_aes$scale) else data &lt;- cbind(data, 
#&gt;     scale = params$scale)
#&gt; debug: data &lt;- cbind(data, scale = self$default_aes$scale)
#&gt; debug: if (!"rel_min_height" %in% names(data)) {
#&gt;     if (!"rel_min_height" %in% names(params)) 
#&gt;         data &lt;- cbind(data, rel_min_height = self$default_aes$rel_min_height)
#&gt;     else data &lt;- cbind(data, rel_min_height = params$rel_min_height)
#&gt; }
#&gt; debug: if (!"rel_min_height" %in% names(params)) data &lt;- cbind(data, 
#&gt;     rel_min_height = self$default_aes$rel_min_height) else data &lt;- cbind(data, 
#&gt;     rel_min_height = params$rel_min_height)
#&gt; debug: data &lt;- cbind(data, rel_min_height = self$default_aes$rel_min_height)
#&gt; debug: data &lt;- transform(data, ymin = y, ymax = y + iscale * scale * 
#&gt;     height, min_height = hmax * rel_min_height)
#&gt; debug: return(data)</code></pre>
<p>more conds</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb27-1" data-line-number="1"><span class="kw">ggplot</span>(mtcars) <span class="op">+</span><span class="st"> </span><span class="kw">geom_bloc</span>(<span class="kw">aes</span>(<span class="dt">x =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(mpg,gear), <span class="dt">y =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(cyl), <span class="dt">height =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="kw">P</span>(mpg <span class="op">|</span><span class="st"> </span>gear, cyl))))</a>
<a class="sourceLine" id="cb27-2" data-line-number="2"><span class="co">#&gt;   marg     cond      aes level</span></a>
<a class="sourceLine" id="cb27-3" data-line-number="3"><span class="co">#&gt; 1    1      cyl   y.cond     1</span></a>
<a class="sourceLine" id="cb27-4" data-line-number="4"><span class="co">#&gt; 2    1     gear   x.cond     2</span></a>
<a class="sourceLine" id="cb27-5" data-line-number="5"><span class="co">#&gt; 3  mpg gear,cyl x.height     3</span></a>
<a class="sourceLine" id="cb27-6" data-line-number="6"><span class="co">#&gt; Warning: Outer names are only allowed for unnamed scalar atomic inputs</span></a>
<a class="sourceLine" id="cb27-7" data-line-number="7"></a>
<a class="sourceLine" id="cb27-8" data-line-number="8"><span class="co">#&gt; Warning: Outer names are only allowed for unnamed scalar atomic inputs</span></a>
<a class="sourceLine" id="cb27-9" data-line-number="9"></a>
<a class="sourceLine" id="cb27-10" data-line-number="10"><span class="co">#&gt; Warning: Outer names are only allowed for unnamed scalar atomic inputs</span></a>
<a class="sourceLine" id="cb27-11" data-line-number="11"><span class="co">#&gt; Aesthetic mapping: </span></a>
<a class="sourceLine" id="cb27-12" data-line-number="12"><span class="co">#&gt; * `x`      -&gt; 1</span></a>
<a class="sourceLine" id="cb27-13" data-line-number="13"><span class="co">#&gt; * `y`      -&gt; 1</span></a>
<a class="sourceLine" id="cb27-14" data-line-number="14"><span class="co">#&gt; * `p.mpg`  -&gt; `mpg`</span></a>
<a class="sourceLine" id="cb27-15" data-line-number="15"><span class="co">#&gt; * `p.gear` -&gt; `gear`</span></a>
<a class="sourceLine" id="cb27-16" data-line-number="16"><span class="co">#&gt; * `p.cyl`  -&gt; `cyl`</span></a>
<a class="sourceLine" id="cb27-17" data-line-number="17"><span class="co">#&gt; Don't know how to automatically pick scale for object of type pgog. Defaulting to continuous.</span></a>
<a class="sourceLine" id="cb27-18" data-line-number="18"><span class="co">#&gt; Don't know how to automatically pick scale for object of type pgog. Defaulting to continuous.</span></a>
<a class="sourceLine" id="cb27-19" data-line-number="19"><span class="co">#&gt; Warning: Outer names are only allowed for unnamed scalar atomic inputs</span></a>
<a class="sourceLine" id="cb27-20" data-line-number="20"></a>
<a class="sourceLine" id="cb27-21" data-line-number="21"><span class="co">#&gt; Warning: Outer names are only allowed for unnamed scalar atomic inputs</span></a>
<a class="sourceLine" id="cb27-22" data-line-number="22"></a>
<a class="sourceLine" id="cb27-23" data-line-number="23"><span class="co">#&gt; Warning: Outer names are only allowed for unnamed scalar atomic inputs</span></a>
<a class="sourceLine" id="cb27-24" data-line-number="24"><span class="co">#&gt; Defaulting to density plots. Use `stat=mosaic` to force mosaic plots</span></a>
<a class="sourceLine" id="cb27-25" data-line-number="25"><span class="co">#&gt; Warning: Computation failed in `stat_bloc()`:</span></a>
<a class="sourceLine" id="cb27-26" data-line-number="26"><span class="co">#&gt; Check aes mapping on the categorial variable  p.gearCheck aes mapping on the categorial variable  p.cyl</span></a></code></pre></div>
<p><img src="pgog_files/figure-html/unnamed-chunk-14-1.png" width="700"></p>
</div>
<div id="pba" class="section level3">
<h3 class="hasAnchor">
<a href="#pba" class="anchor"></a>P(B|A, â€¦)</h3>
<p>TODO: position needs to be â€œfillâ€</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb28-1" data-line-number="1"><span class="kw">ggplot</span>(mtcars) <span class="op">+</span><span class="st"> </span><span class="kw">geom_bloc</span>(<span class="kw">aes</span>(<span class="dt">x =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(mpg), <span class="dt">height =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="kw">P</span>(cyl <span class="op">|</span><span class="st"> </span>mpg)), <span class="dt">fill =</span> <span class="kw"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(cyl)))</a>
<a class="sourceLine" id="cb28-2" data-line-number="2"><span class="co">#&gt;   marg cond         aes level</span></a>
<a class="sourceLine" id="cb28-3" data-line-number="3"><span class="co">#&gt; 1    1  mpg      x.cond     1</span></a>
<a class="sourceLine" id="cb28-4" data-line-number="4"><span class="co">#&gt; 2  cyl  mpg fill.height     2</span></a>
<a class="sourceLine" id="cb28-5" data-line-number="5"><span class="co">#&gt; Warning: Outer names are only allowed for unnamed scalar atomic inputs</span></a>
<a class="sourceLine" id="cb28-6" data-line-number="6"></a>
<a class="sourceLine" id="cb28-7" data-line-number="7"><span class="co">#&gt; Warning: Outer names are only allowed for unnamed scalar atomic inputs</span></a>
<a class="sourceLine" id="cb28-8" data-line-number="8"></a>
<a class="sourceLine" id="cb28-9" data-line-number="9"><span class="co">#&gt; Warning: Outer names are only allowed for unnamed scalar atomic inputs</span></a>
<a class="sourceLine" id="cb28-10" data-line-number="10"><span class="co">#&gt; Aesthetic mapping: </span></a>
<a class="sourceLine" id="cb28-11" data-line-number="11"><span class="co">#&gt; * `x`     -&gt; 1</span></a>
<a class="sourceLine" id="cb28-12" data-line-number="12"><span class="co">#&gt; * `fill`  -&gt; `factor(cyl)`</span></a>
<a class="sourceLine" id="cb28-13" data-line-number="13"><span class="co">#&gt; * `p.cyl` -&gt; `cyl`</span></a>
<a class="sourceLine" id="cb28-14" data-line-number="14"><span class="co">#&gt; * `p.mpg` -&gt; `mpg`</span></a>
<a class="sourceLine" id="cb28-15" data-line-number="15"><span class="co">#&gt; * `y`     -&gt; 1</span></a>
<a class="sourceLine" id="cb28-16" data-line-number="16"><span class="co">#&gt; Don't know how to automatically pick scale for object of type pgog. Defaulting to continuous.</span></a>
<a class="sourceLine" id="cb28-17" data-line-number="17"><span class="co">#&gt; Don't know how to automatically pick scale for object of type pgog. Defaulting to continuous.</span></a>
<a class="sourceLine" id="cb28-18" data-line-number="18"><span class="co">#&gt; Warning: Outer names are only allowed for unnamed scalar atomic inputs</span></a>
<a class="sourceLine" id="cb28-19" data-line-number="19"></a>
<a class="sourceLine" id="cb28-20" data-line-number="20"><span class="co">#&gt; Warning: Outer names are only allowed for unnamed scalar atomic inputs</span></a>
<a class="sourceLine" id="cb28-21" data-line-number="21"></a>
<a class="sourceLine" id="cb28-22" data-line-number="22"><span class="co">#&gt; Warning: Outer names are only allowed for unnamed scalar atomic inputs</span></a>
<a class="sourceLine" id="cb28-23" data-line-number="23"><span class="co">#&gt; Defaulting to density plots. Use `stat=mosaic` to force mosaic plots</span></a>
<a class="sourceLine" id="cb28-24" data-line-number="24"><span class="co">#&gt; Warning in if (!is.na(res$density)) {: the condition has length &gt; 1 and only the</span></a>
<a class="sourceLine" id="cb28-25" data-line-number="25"><span class="co">#&gt; first element will be used</span></a>
<a class="sourceLine" id="cb28-26" data-line-number="26"><span class="co">#&gt; Warning in if (!is.na(res$density)) {: the condition has length &gt; 1 and only the</span></a>
<a class="sourceLine" id="cb28-27" data-line-number="27"><span class="co">#&gt; first element will be used</span></a>
<a class="sourceLine" id="cb28-28" data-line-number="28"></a>
<a class="sourceLine" id="cb28-29" data-line-number="29"><span class="co">#&gt; Warning in if (!is.na(res$density)) {: the condition has length &gt; 1 and only the</span></a>
<a class="sourceLine" id="cb28-30" data-line-number="30"><span class="co">#&gt; first element will be used</span></a></code></pre></div>
<p><img src="pgog_files/figure-html/unnamed-chunk-15-1.png" width="700"></p>
<pre><code>#&gt; Called from: f(..., self = self)
#&gt; debug: if ("density" %in% names(data)) {
#&gt;     data &lt;- transform(data[order(data$PANEL, data$group, data$x), 
#&gt;         ], ymin = 0, ymax = y)
#&gt;     if ("height" %in% names(data)) {
#&gt;         if (is.null(params$panel_scaling)) {
#&gt;             params$panel_scaling &lt;- TRUE
#&gt;         }
#&gt;         yrange = max(data$y) - min(data$y)
#&gt;         n = length(unique(data$y))
#&gt;         if (n &lt; 2) {
#&gt;             hmax &lt;- max(data$height, na.rm = TRUE)
#&gt;             iscale &lt;- 1
#&gt;         }
#&gt;         else {
#&gt;             if (params$panel_scaling) {
#&gt;                 heights &lt;- split(data$height, data$PANEL)
#&gt;                 max_heights &lt;- vapply(heights, max, numeric(1), 
#&gt;                   na.rm = TRUE)
#&gt;                 hmax &lt;- max_heights[data$PANEL]
#&gt;                 iscale &lt;- yrange/((n - 1) * hmax)
#&gt;             }
#&gt;             else {
#&gt;                 hmax &lt;- max(data$height, na.rm = TRUE)
#&gt;                 iscale &lt;- yrange/((n - 1) * hmax)
#&gt;             }
#&gt;         }
#&gt;         data &lt;- cbind(data, iscale)
#&gt;         if (!"scale" %in% names(data)) {
#&gt;             if (!"scale" %in% names(params)) 
#&gt;                 data &lt;- cbind(data, scale = self$default_aes$scale)
#&gt;             else data &lt;- cbind(data, scale = params$scale)
#&gt;         }
#&gt;         if (!"rel_min_height" %in% names(data)) {
#&gt;             if (!"rel_min_height" %in% names(params)) 
#&gt;                 data &lt;- cbind(data, rel_min_height = self$default_aes$rel_min_height)
#&gt;             else data &lt;- cbind(data, rel_min_height = params$rel_min_height)
#&gt;         }
#&gt;         data &lt;- transform(data, ymin = y, ymax = y + iscale * 
#&gt;             scale * height, min_height = hmax * rel_min_height)
#&gt;         return(data)
#&gt;     }
#&gt;     data
#&gt; } else {
#&gt;     subset(data, level == max(data$level))
#&gt; }
#&gt; debug: data &lt;- transform(data[order(data$PANEL, data$group, data$x), 
#&gt;     ], ymin = 0, ymax = y)
#&gt; debug: if ("height" %in% names(data)) {
#&gt;     if (is.null(params$panel_scaling)) {
#&gt;         params$panel_scaling &lt;- TRUE
#&gt;     }
#&gt;     yrange = max(data$y) - min(data$y)
#&gt;     n = length(unique(data$y))
#&gt;     if (n &lt; 2) {
#&gt;         hmax &lt;- max(data$height, na.rm = TRUE)
#&gt;         iscale &lt;- 1
#&gt;     }
#&gt;     else {
#&gt;         if (params$panel_scaling) {
#&gt;             heights &lt;- split(data$height, data$PANEL)
#&gt;             max_heights &lt;- vapply(heights, max, numeric(1), na.rm = TRUE)
#&gt;             hmax &lt;- max_heights[data$PANEL]
#&gt;             iscale &lt;- yrange/((n - 1) * hmax)
#&gt;         }
#&gt;         else {
#&gt;             hmax &lt;- max(data$height, na.rm = TRUE)
#&gt;             iscale &lt;- yrange/((n - 1) * hmax)
#&gt;         }
#&gt;     }
#&gt;     data &lt;- cbind(data, iscale)
#&gt;     if (!"scale" %in% names(data)) {
#&gt;         if (!"scale" %in% names(params)) 
#&gt;             data &lt;- cbind(data, scale = self$default_aes$scale)
#&gt;         else data &lt;- cbind(data, scale = params$scale)
#&gt;     }
#&gt;     if (!"rel_min_height" %in% names(data)) {
#&gt;         if (!"rel_min_height" %in% names(params)) 
#&gt;             data &lt;- cbind(data, rel_min_height = self$default_aes$rel_min_height)
#&gt;         else data &lt;- cbind(data, rel_min_height = params$rel_min_height)
#&gt;     }
#&gt;     data &lt;- transform(data, ymin = y, ymax = y + iscale * scale * 
#&gt;         height, min_height = hmax * rel_min_height)
#&gt;     return(data)
#&gt; }
#&gt; debug: data</code></pre>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb30-1" data-line-number="1"><span class="kw">ggplot</span>(mtcars) <span class="op">+</span><span class="st"> </span><span class="kw">geom_bloc</span>(<span class="kw">aes</span>(<span class="dt">x =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(mpg, gear), <span class="dt">height =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="kw">P</span>(cyl <span class="op">|</span><span class="st"> </span>gear,mpg))))</a>
<a class="sourceLine" id="cb30-2" data-line-number="2"><span class="co">#&gt;   marg     cond    aes level</span></a>
<a class="sourceLine" id="cb30-3" data-line-number="3"><span class="co">#&gt; 1    1      mpg x.cond     1</span></a>
<a class="sourceLine" id="cb30-4" data-line-number="4"><span class="co">#&gt; 2    1     gear x.cond     2</span></a>
<a class="sourceLine" id="cb30-5" data-line-number="5"><span class="co">#&gt; 3  cyl gear,mpg height     3</span></a>
<a class="sourceLine" id="cb30-6" data-line-number="6"><span class="co">#&gt; Warning: Outer names are only allowed for unnamed scalar atomic inputs</span></a>
<a class="sourceLine" id="cb30-7" data-line-number="7"></a>
<a class="sourceLine" id="cb30-8" data-line-number="8"><span class="co">#&gt; Warning: Outer names are only allowed for unnamed scalar atomic inputs</span></a>
<a class="sourceLine" id="cb30-9" data-line-number="9"></a>
<a class="sourceLine" id="cb30-10" data-line-number="10"><span class="co">#&gt; Warning: Outer names are only allowed for unnamed scalar atomic inputs</span></a>
<a class="sourceLine" id="cb30-11" data-line-number="11"><span class="co">#&gt; Aesthetic mapping: </span></a>
<a class="sourceLine" id="cb30-12" data-line-number="12"><span class="co">#&gt; * `x`      -&gt; 1</span></a>
<a class="sourceLine" id="cb30-13" data-line-number="13"><span class="co">#&gt; * `p.cyl`  -&gt; `cyl`</span></a>
<a class="sourceLine" id="cb30-14" data-line-number="14"><span class="co">#&gt; * `p.gear` -&gt; `gear`</span></a>
<a class="sourceLine" id="cb30-15" data-line-number="15"><span class="co">#&gt; * `p.mpg`  -&gt; `mpg`</span></a>
<a class="sourceLine" id="cb30-16" data-line-number="16"><span class="co">#&gt; * `y`      -&gt; 1</span></a>
<a class="sourceLine" id="cb30-17" data-line-number="17"><span class="co">#&gt; Don't know how to automatically pick scale for object of type pgog. Defaulting to continuous.</span></a>
<a class="sourceLine" id="cb30-18" data-line-number="18"><span class="co">#&gt; Don't know how to automatically pick scale for object of type pgog. Defaulting to continuous.</span></a>
<a class="sourceLine" id="cb30-19" data-line-number="19"><span class="co">#&gt; Warning: Outer names are only allowed for unnamed scalar atomic inputs</span></a>
<a class="sourceLine" id="cb30-20" data-line-number="20"></a>
<a class="sourceLine" id="cb30-21" data-line-number="21"><span class="co">#&gt; Warning: Outer names are only allowed for unnamed scalar atomic inputs</span></a>
<a class="sourceLine" id="cb30-22" data-line-number="22"></a>
<a class="sourceLine" id="cb30-23" data-line-number="23"><span class="co">#&gt; Warning: Outer names are only allowed for unnamed scalar atomic inputs</span></a>
<a class="sourceLine" id="cb30-24" data-line-number="24"><span class="co">#&gt; Defaulting to density plots. Use `stat=mosaic` to force mosaic plots</span></a>
<a class="sourceLine" id="cb30-25" data-line-number="25"><span class="co">#&gt; Warning in if (!is.na(res$density)) {: the condition has length &gt; 1 and only the</span></a>
<a class="sourceLine" id="cb30-26" data-line-number="26"><span class="co">#&gt; first element will be used</span></a>
<a class="sourceLine" id="cb30-27" data-line-number="27"><span class="co">#&gt; Warning in if (!is.na(res$density)) {: the condition has length &gt; 1 and only the</span></a>
<a class="sourceLine" id="cb30-28" data-line-number="28"><span class="co">#&gt; first element will be used</span></a>
<a class="sourceLine" id="cb30-29" data-line-number="29"></a>
<a class="sourceLine" id="cb30-30" data-line-number="30"><span class="co">#&gt; Warning in if (!is.na(res$density)) {: the condition has length &gt; 1 and only the</span></a>
<a class="sourceLine" id="cb30-31" data-line-number="31"><span class="co">#&gt; first element will be used</span></a></code></pre></div>
<p><img src="pgog_files/figure-html/unnamed-chunk-16-1.png" width="700"></p>
<pre><code>#&gt; Called from: f(..., self = self)
#&gt; debug: if ("density" %in% names(data)) {
#&gt;     data &lt;- transform(data[order(data$PANEL, data$group, data$x), 
#&gt;         ], ymin = 0, ymax = y)
#&gt;     if ("height" %in% names(data)) {
#&gt;         if (is.null(params$panel_scaling)) {
#&gt;             params$panel_scaling &lt;- TRUE
#&gt;         }
#&gt;         yrange = max(data$y) - min(data$y)
#&gt;         n = length(unique(data$y))
#&gt;         if (n &lt; 2) {
#&gt;             hmax &lt;- max(data$height, na.rm = TRUE)
#&gt;             iscale &lt;- 1
#&gt;         }
#&gt;         else {
#&gt;             if (params$panel_scaling) {
#&gt;                 heights &lt;- split(data$height, data$PANEL)
#&gt;                 max_heights &lt;- vapply(heights, max, numeric(1), 
#&gt;                   na.rm = TRUE)
#&gt;                 hmax &lt;- max_heights[data$PANEL]
#&gt;                 iscale &lt;- yrange/((n - 1) * hmax)
#&gt;             }
#&gt;             else {
#&gt;                 hmax &lt;- max(data$height, na.rm = TRUE)
#&gt;                 iscale &lt;- yrange/((n - 1) * hmax)
#&gt;             }
#&gt;         }
#&gt;         data &lt;- cbind(data, iscale)
#&gt;         if (!"scale" %in% names(data)) {
#&gt;             if (!"scale" %in% names(params)) 
#&gt;                 data &lt;- cbind(data, scale = self$default_aes$scale)
#&gt;             else data &lt;- cbind(data, scale = params$scale)
#&gt;         }
#&gt;         if (!"rel_min_height" %in% names(data)) {
#&gt;             if (!"rel_min_height" %in% names(params)) 
#&gt;                 data &lt;- cbind(data, rel_min_height = self$default_aes$rel_min_height)
#&gt;             else data &lt;- cbind(data, rel_min_height = params$rel_min_height)
#&gt;         }
#&gt;         data &lt;- transform(data, ymin = y, ymax = y + iscale * 
#&gt;             scale * height, min_height = hmax * rel_min_height)
#&gt;         return(data)
#&gt;     }
#&gt;     data
#&gt; } else {
#&gt;     subset(data, level == max(data$level))
#&gt; }
#&gt; debug: data &lt;- transform(data[order(data$PANEL, data$group, data$x), 
#&gt;     ], ymin = 0, ymax = y)
#&gt; debug: if ("height" %in% names(data)) {
#&gt;     if (is.null(params$panel_scaling)) {
#&gt;         params$panel_scaling &lt;- TRUE
#&gt;     }
#&gt;     yrange = max(data$y) - min(data$y)
#&gt;     n = length(unique(data$y))
#&gt;     if (n &lt; 2) {
#&gt;         hmax &lt;- max(data$height, na.rm = TRUE)
#&gt;         iscale &lt;- 1
#&gt;     }
#&gt;     else {
#&gt;         if (params$panel_scaling) {
#&gt;             heights &lt;- split(data$height, data$PANEL)
#&gt;             max_heights &lt;- vapply(heights, max, numeric(1), na.rm = TRUE)
#&gt;             hmax &lt;- max_heights[data$PANEL]
#&gt;             iscale &lt;- yrange/((n - 1) * hmax)
#&gt;         }
#&gt;         else {
#&gt;             hmax &lt;- max(data$height, na.rm = TRUE)
#&gt;             iscale &lt;- yrange/((n - 1) * hmax)
#&gt;         }
#&gt;     }
#&gt;     data &lt;- cbind(data, iscale)
#&gt;     if (!"scale" %in% names(data)) {
#&gt;         if (!"scale" %in% names(params)) 
#&gt;             data &lt;- cbind(data, scale = self$default_aes$scale)
#&gt;         else data &lt;- cbind(data, scale = params$scale)
#&gt;     }
#&gt;     if (!"rel_min_height" %in% names(data)) {
#&gt;         if (!"rel_min_height" %in% names(params)) 
#&gt;             data &lt;- cbind(data, rel_min_height = self$default_aes$rel_min_height)
#&gt;         else data &lt;- cbind(data, rel_min_height = params$rel_min_height)
#&gt;     }
#&gt;     data &lt;- transform(data, ymin = y, ymax = y + iscale * scale * 
#&gt;         height, min_height = hmax * rel_min_height)
#&gt;     return(data)
#&gt; }
#&gt; debug: data</code></pre>
</div>
<div id="pba-1" class="section level3">
<h3 class="hasAnchor">
<a href="#pba-1" class="anchor"></a>P(B,A,â€¦)</h3>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb32-1" data-line-number="1">common_bw &lt;-<span class="st"> </span><span class="fl">1.5</span></a>
<a class="sourceLine" id="cb32-2" data-line-number="2"></a>
<a class="sourceLine" id="cb32-3" data-line-number="3"></a>
<a class="sourceLine" id="cb32-4" data-line-number="4"><span class="kw">ggplot</span>(mtcars) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb32-5" data-line-number="5"><span class="st">  </span><span class="kw">geom_bloc</span>(<span class="kw">aes</span>(</a>
<a class="sourceLine" id="cb32-6" data-line-number="6">    <span class="dt">x =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(mpg), </a>
<a class="sourceLine" id="cb32-7" data-line-number="7">    <span class="dt">height =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="kw">P</span>(cyl<span class="op">|</span>mpg), <span class="kw">P</span>(mpg)), </a>
<a class="sourceLine" id="cb32-8" data-line-number="8">    <span class="dt">fill =</span> <span class="kw"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(cyl)), <span class="dt">bw =</span> common_bw) <span class="op">+</span></a>
<a class="sourceLine" id="cb32-9" data-line-number="9"><span class="st">  </span><span class="kw">xlab</span>(<span class="st">"mpg"</span>)</a>
<a class="sourceLine" id="cb32-10" data-line-number="10"><span class="co">#&gt;   marg cond         aes level</span></a>
<a class="sourceLine" id="cb32-11" data-line-number="11"><span class="co">#&gt; 1  mpg         x.height     1</span></a>
<a class="sourceLine" id="cb32-12" data-line-number="12"><span class="co">#&gt; 2  cyl  mpg fill.height     2</span></a>
<a class="sourceLine" id="cb32-13" data-line-number="13"><span class="co">#&gt; Aesthetic mapping: </span></a>
<a class="sourceLine" id="cb32-14" data-line-number="14"><span class="co">#&gt; * `x`     -&gt; 1</span></a>
<a class="sourceLine" id="cb32-15" data-line-number="15"><span class="co">#&gt; * `fill`  -&gt; `factor(cyl)`</span></a>
<a class="sourceLine" id="cb32-16" data-line-number="16"><span class="co">#&gt; * `p.cyl` -&gt; `cyl`</span></a>
<a class="sourceLine" id="cb32-17" data-line-number="17"><span class="co">#&gt; * `p.mpg` -&gt; `mpg`</span></a>
<a class="sourceLine" id="cb32-18" data-line-number="18"><span class="co">#&gt; * `y`     -&gt; 1</span></a>
<a class="sourceLine" id="cb32-19" data-line-number="19"><span class="co">#&gt; Don't know how to automatically pick scale for object of type pgog. Defaulting to continuous.</span></a>
<a class="sourceLine" id="cb32-20" data-line-number="20"><span class="co">#&gt; Don't know how to automatically pick scale for object of type pgog. Defaulting to continuous.</span></a>
<a class="sourceLine" id="cb32-21" data-line-number="21"><span class="co">#&gt; Defaulting to density plots. Use `stat=mosaic` to force mosaic plots</span></a>
<a class="sourceLine" id="cb32-22" data-line-number="22"><span class="co">#&gt; Warning in if (!is.na(res$density)) {: the condition has length &gt; 1 and only the</span></a>
<a class="sourceLine" id="cb32-23" data-line-number="23"><span class="co">#&gt; first element will be used</span></a>
<a class="sourceLine" id="cb32-24" data-line-number="24"></a>
<a class="sourceLine" id="cb32-25" data-line-number="25"><span class="co">#&gt; Warning in if (!is.na(res$density)) {: the condition has length &gt; 1 and only the</span></a>
<a class="sourceLine" id="cb32-26" data-line-number="26"><span class="co">#&gt; first element will be used</span></a>
<a class="sourceLine" id="cb32-27" data-line-number="27"></a>
<a class="sourceLine" id="cb32-28" data-line-number="28"><span class="co">#&gt; Warning in if (!is.na(res$density)) {: the condition has length &gt; 1 and only the</span></a>
<a class="sourceLine" id="cb32-29" data-line-number="29"><span class="co">#&gt; first element will be used</span></a></code></pre></div>
<p><img src="pgog_files/figure-html/unnamed-chunk-17-1.png" width="700"></p>
<pre><code>#&gt; Called from: f(..., self = self)
#&gt; debug: if ("density" %in% names(data)) {
#&gt;     data &lt;- transform(data[order(data$PANEL, data$group, data$x), 
#&gt;         ], ymin = 0, ymax = y)
#&gt;     if ("height" %in% names(data)) {
#&gt;         if (is.null(params$panel_scaling)) {
#&gt;             params$panel_scaling &lt;- TRUE
#&gt;         }
#&gt;         yrange = max(data$y) - min(data$y)
#&gt;         n = length(unique(data$y))
#&gt;         if (n &lt; 2) {
#&gt;             hmax &lt;- max(data$height, na.rm = TRUE)
#&gt;             iscale &lt;- 1
#&gt;         }
#&gt;         else {
#&gt;             if (params$panel_scaling) {
#&gt;                 heights &lt;- split(data$height, data$PANEL)
#&gt;                 max_heights &lt;- vapply(heights, max, numeric(1), 
#&gt;                   na.rm = TRUE)
#&gt;                 hmax &lt;- max_heights[data$PANEL]
#&gt;                 iscale &lt;- yrange/((n - 1) * hmax)
#&gt;             }
#&gt;             else {
#&gt;                 hmax &lt;- max(data$height, na.rm = TRUE)
#&gt;                 iscale &lt;- yrange/((n - 1) * hmax)
#&gt;             }
#&gt;         }
#&gt;         data &lt;- cbind(data, iscale)
#&gt;         if (!"scale" %in% names(data)) {
#&gt;             if (!"scale" %in% names(params)) 
#&gt;                 data &lt;- cbind(data, scale = self$default_aes$scale)
#&gt;             else data &lt;- cbind(data, scale = params$scale)
#&gt;         }
#&gt;         if (!"rel_min_height" %in% names(data)) {
#&gt;             if (!"rel_min_height" %in% names(params)) 
#&gt;                 data &lt;- cbind(data, rel_min_height = self$default_aes$rel_min_height)
#&gt;             else data &lt;- cbind(data, rel_min_height = params$rel_min_height)
#&gt;         }
#&gt;         data &lt;- transform(data, ymin = y, ymax = y + iscale * 
#&gt;             scale * height, min_height = hmax * rel_min_height)
#&gt;         return(data)
#&gt;     }
#&gt;     data
#&gt; } else {
#&gt;     subset(data, level == max(data$level))
#&gt; }
#&gt; debug: data &lt;- transform(data[order(data$PANEL, data$group, data$x), 
#&gt;     ], ymin = 0, ymax = y)
#&gt; debug: if ("height" %in% names(data)) {
#&gt;     if (is.null(params$panel_scaling)) {
#&gt;         params$panel_scaling &lt;- TRUE
#&gt;     }
#&gt;     yrange = max(data$y) - min(data$y)
#&gt;     n = length(unique(data$y))
#&gt;     if (n &lt; 2) {
#&gt;         hmax &lt;- max(data$height, na.rm = TRUE)
#&gt;         iscale &lt;- 1
#&gt;     }
#&gt;     else {
#&gt;         if (params$panel_scaling) {
#&gt;             heights &lt;- split(data$height, data$PANEL)
#&gt;             max_heights &lt;- vapply(heights, max, numeric(1), na.rm = TRUE)
#&gt;             hmax &lt;- max_heights[data$PANEL]
#&gt;             iscale &lt;- yrange/((n - 1) * hmax)
#&gt;         }
#&gt;         else {
#&gt;             hmax &lt;- max(data$height, na.rm = TRUE)
#&gt;             iscale &lt;- yrange/((n - 1) * hmax)
#&gt;         }
#&gt;     }
#&gt;     data &lt;- cbind(data, iscale)
#&gt;     if (!"scale" %in% names(data)) {
#&gt;         if (!"scale" %in% names(params)) 
#&gt;             data &lt;- cbind(data, scale = self$default_aes$scale)
#&gt;         else data &lt;- cbind(data, scale = params$scale)
#&gt;     }
#&gt;     if (!"rel_min_height" %in% names(data)) {
#&gt;         if (!"rel_min_height" %in% names(params)) 
#&gt;             data &lt;- cbind(data, rel_min_height = self$default_aes$rel_min_height)
#&gt;         else data &lt;- cbind(data, rel_min_height = params$rel_min_height)
#&gt;     }
#&gt;     data &lt;- transform(data, ymin = y, ymax = y + iscale * scale * 
#&gt;         height, min_height = hmax * rel_min_height)
#&gt;     return(data)
#&gt; }
#&gt; debug: data</code></pre>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb34-1" data-line-number="1"><span class="kw">ggplot</span>(mtcars) <span class="op">+</span><span class="st"> </span><span class="kw">geom_bloc</span>(<span class="kw">aes</span>(<span class="dt">x =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(hp, gear), <span class="dt">fill =</span> <span class="kw"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(cyl), <span class="dt">height =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="kw">P</span>(cyl<span class="op">|</span>hp, gear), <span class="kw">P</span>(hp<span class="op">|</span>gear))))</a>
<a class="sourceLine" id="cb34-2" data-line-number="2"><span class="co">#&gt;   marg    cond         aes level</span></a>
<a class="sourceLine" id="cb34-3" data-line-number="3"><span class="co">#&gt; 1    1    gear      x.cond     1</span></a>
<a class="sourceLine" id="cb34-4" data-line-number="4"><span class="co">#&gt; 2   hp    gear    x.height     2</span></a>
<a class="sourceLine" id="cb34-5" data-line-number="5"><span class="co">#&gt; 3  cyl hp,gear fill.height     3</span></a>
<a class="sourceLine" id="cb34-6" data-line-number="6"><span class="co">#&gt; Aesthetic mapping: </span></a>
<a class="sourceLine" id="cb34-7" data-line-number="7"><span class="co">#&gt; * `x`      -&gt; 1</span></a>
<a class="sourceLine" id="cb34-8" data-line-number="8"><span class="co">#&gt; * `fill`   -&gt; `factor(cyl)`</span></a>
<a class="sourceLine" id="cb34-9" data-line-number="9"><span class="co">#&gt; * `p.cyl`  -&gt; `cyl`</span></a>
<a class="sourceLine" id="cb34-10" data-line-number="10"><span class="co">#&gt; * `p.hp`   -&gt; `hp`</span></a>
<a class="sourceLine" id="cb34-11" data-line-number="11"><span class="co">#&gt; * `p.gear` -&gt; `gear`</span></a>
<a class="sourceLine" id="cb34-12" data-line-number="12"><span class="co">#&gt; * `y`      -&gt; 1</span></a>
<a class="sourceLine" id="cb34-13" data-line-number="13"><span class="co">#&gt; Don't know how to automatically pick scale for object of type pgog. Defaulting to continuous.</span></a>
<a class="sourceLine" id="cb34-14" data-line-number="14"><span class="co">#&gt; Don't know how to automatically pick scale for object of type pgog. Defaulting to continuous.</span></a>
<a class="sourceLine" id="cb34-15" data-line-number="15"><span class="co">#&gt; Defaulting to density plots. Use `stat=mosaic` to force mosaic plots</span></a>
<a class="sourceLine" id="cb34-16" data-line-number="16"><span class="co">#&gt; Warning in if (!is.na(res$density)) {: the condition has length &gt; 1 and only the</span></a>
<a class="sourceLine" id="cb34-17" data-line-number="17"><span class="co">#&gt; first element will be used</span></a>
<a class="sourceLine" id="cb34-18" data-line-number="18"></a>
<a class="sourceLine" id="cb34-19" data-line-number="19"><span class="co">#&gt; Warning in if (!is.na(res$density)) {: the condition has length &gt; 1 and only the</span></a>
<a class="sourceLine" id="cb34-20" data-line-number="20"><span class="co">#&gt; first element will be used</span></a>
<a class="sourceLine" id="cb34-21" data-line-number="21"></a>
<a class="sourceLine" id="cb34-22" data-line-number="22"><span class="co">#&gt; Warning in if (!is.na(res$density)) {: the condition has length &gt; 1 and only the</span></a>
<a class="sourceLine" id="cb34-23" data-line-number="23"><span class="co">#&gt; first element will be used</span></a></code></pre></div>
<p><img src="pgog_files/figure-html/unnamed-chunk-18-1.png" width="700"></p>
<pre><code>#&gt; Called from: f(..., self = self)
#&gt; debug: if ("density" %in% names(data)) {
#&gt;     data &lt;- transform(data[order(data$PANEL, data$group, data$x), 
#&gt;         ], ymin = 0, ymax = y)
#&gt;     if ("height" %in% names(data)) {
#&gt;         if (is.null(params$panel_scaling)) {
#&gt;             params$panel_scaling &lt;- TRUE
#&gt;         }
#&gt;         yrange = max(data$y) - min(data$y)
#&gt;         n = length(unique(data$y))
#&gt;         if (n &lt; 2) {
#&gt;             hmax &lt;- max(data$height, na.rm = TRUE)
#&gt;             iscale &lt;- 1
#&gt;         }
#&gt;         else {
#&gt;             if (params$panel_scaling) {
#&gt;                 heights &lt;- split(data$height, data$PANEL)
#&gt;                 max_heights &lt;- vapply(heights, max, numeric(1), 
#&gt;                   na.rm = TRUE)
#&gt;                 hmax &lt;- max_heights[data$PANEL]
#&gt;                 iscale &lt;- yrange/((n - 1) * hmax)
#&gt;             }
#&gt;             else {
#&gt;                 hmax &lt;- max(data$height, na.rm = TRUE)
#&gt;                 iscale &lt;- yrange/((n - 1) * hmax)
#&gt;             }
#&gt;         }
#&gt;         data &lt;- cbind(data, iscale)
#&gt;         if (!"scale" %in% names(data)) {
#&gt;             if (!"scale" %in% names(params)) 
#&gt;                 data &lt;- cbind(data, scale = self$default_aes$scale)
#&gt;             else data &lt;- cbind(data, scale = params$scale)
#&gt;         }
#&gt;         if (!"rel_min_height" %in% names(data)) {
#&gt;             if (!"rel_min_height" %in% names(params)) 
#&gt;                 data &lt;- cbind(data, rel_min_height = self$default_aes$rel_min_height)
#&gt;             else data &lt;- cbind(data, rel_min_height = params$rel_min_height)
#&gt;         }
#&gt;         data &lt;- transform(data, ymin = y, ymax = y + iscale * 
#&gt;             scale * height, min_height = hmax * rel_min_height)
#&gt;         return(data)
#&gt;     }
#&gt;     data
#&gt; } else {
#&gt;     subset(data, level == max(data$level))
#&gt; }
#&gt; debug: data &lt;- transform(data[order(data$PANEL, data$group, data$x), 
#&gt;     ], ymin = 0, ymax = y)
#&gt; debug: if ("height" %in% names(data)) {
#&gt;     if (is.null(params$panel_scaling)) {
#&gt;         params$panel_scaling &lt;- TRUE
#&gt;     }
#&gt;     yrange = max(data$y) - min(data$y)
#&gt;     n = length(unique(data$y))
#&gt;     if (n &lt; 2) {
#&gt;         hmax &lt;- max(data$height, na.rm = TRUE)
#&gt;         iscale &lt;- 1
#&gt;     }
#&gt;     else {
#&gt;         if (params$panel_scaling) {
#&gt;             heights &lt;- split(data$height, data$PANEL)
#&gt;             max_heights &lt;- vapply(heights, max, numeric(1), na.rm = TRUE)
#&gt;             hmax &lt;- max_heights[data$PANEL]
#&gt;             iscale &lt;- yrange/((n - 1) * hmax)
#&gt;         }
#&gt;         else {
#&gt;             hmax &lt;- max(data$height, na.rm = TRUE)
#&gt;             iscale &lt;- yrange/((n - 1) * hmax)
#&gt;         }
#&gt;     }
#&gt;     data &lt;- cbind(data, iscale)
#&gt;     if (!"scale" %in% names(data)) {
#&gt;         if (!"scale" %in% names(params)) 
#&gt;             data &lt;- cbind(data, scale = self$default_aes$scale)
#&gt;         else data &lt;- cbind(data, scale = params$scale)
#&gt;     }
#&gt;     if (!"rel_min_height" %in% names(data)) {
#&gt;         if (!"rel_min_height" %in% names(params)) 
#&gt;             data &lt;- cbind(data, rel_min_height = self$default_aes$rel_min_height)
#&gt;         else data &lt;- cbind(data, rel_min_height = params$rel_min_height)
#&gt;     }
#&gt;     data &lt;- transform(data, ymin = y, ymax = y + iscale * scale * 
#&gt;         height, min_height = hmax * rel_min_height)
#&gt;     return(data)
#&gt; }
#&gt; debug: data</code></pre>
<p>TODO: more conds</p>
</div>
</div>
</div>
<div id="geom_icon" class="section level1">
<h1 class="hasAnchor">
<a href="#geom_icon" class="anchor"></a>geom_icon</h1>
<p>Using <code>geom_bloc</code> first to get the base partition right</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb36-1" data-line-number="1"><span class="kw">ggplot</span>(mtcars) <span class="op">+</span><span class="st"> </span><span class="kw">geom_icon</span>(<span class="kw">aes</span>(<span class="dt">height =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="kw">P</span>(cyl<span class="op">|</span>gear)), <span class="dt">x =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(gear), <span class="dt">fill =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(cyl))), <span class="dt">stat =</span> <span class="st">"icon"</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb36-2" data-line-number="2"><span class="st">  </span><span class="kw">scale_fill_brewer</span>(<span class="dt">palette =</span> <span class="st">"Accent"</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb36-3" data-line-number="3"><span class="st">  </span><span class="kw">theme_minimal</span>() </a>
<a class="sourceLine" id="cb36-4" data-line-number="4"><span class="co">#&gt; Warning in if (marg == pvar) {: the condition has length &gt; 1 and only the first</span></a>
<a class="sourceLine" id="cb36-5" data-line-number="5"><span class="co">#&gt; element will be used</span></a>
<a class="sourceLine" id="cb36-6" data-line-number="6"></a>
<a class="sourceLine" id="cb36-7" data-line-number="7"><span class="co">#&gt; Warning in if (marg == pvar) {: the condition has length &gt; 1 and only the first</span></a>
<a class="sourceLine" id="cb36-8" data-line-number="8"><span class="co">#&gt; element will be used</span></a>
<a class="sourceLine" id="cb36-9" data-line-number="9"><span class="co">#&gt;   marg cond    aes level</span></a>
<a class="sourceLine" id="cb36-10" data-line-number="10"><span class="co">#&gt; 1    1 gear x.cond     1</span></a>
<a class="sourceLine" id="cb36-11" data-line-number="11"><span class="co">#&gt; 2  cyl gear height     2</span></a>
<a class="sourceLine" id="cb36-12" data-line-number="12"><span class="co">#&gt; Warning: Outer names are only allowed for unnamed scalar atomic inputs</span></a>
<a class="sourceLine" id="cb36-13" data-line-number="13"><span class="co">#&gt; Warning: Outer names are only allowed for unnamed scalar atomic inputs</span></a>
<a class="sourceLine" id="cb36-14" data-line-number="14"></a>
<a class="sourceLine" id="cb36-15" data-line-number="15"><span class="co">#&gt; Warning: Outer names are only allowed for unnamed scalar atomic inputs</span></a>
<a class="sourceLine" id="cb36-16" data-line-number="16"><span class="co">#&gt; Don't know how to automatically pick scale for object of type pgog. Defaulting to continuous.</span></a>
<a class="sourceLine" id="cb36-17" data-line-number="17"><span class="co">#&gt; Don't know how to automatically pick scale for object of type pgog. Defaulting to continuous.</span></a>
<a class="sourceLine" id="cb36-18" data-line-number="18"><span class="co">#&gt; Warning: Outer names are only allowed for unnamed scalar atomic inputs</span></a>
<a class="sourceLine" id="cb36-19" data-line-number="19"></a>
<a class="sourceLine" id="cb36-20" data-line-number="20"><span class="co">#&gt; Warning: Outer names are only allowed for unnamed scalar atomic inputs</span></a>
<a class="sourceLine" id="cb36-21" data-line-number="21"></a>
<a class="sourceLine" id="cb36-22" data-line-number="22"><span class="co">#&gt; Warning: Outer names are only allowed for unnamed scalar atomic inputs</span></a>
<a class="sourceLine" id="cb36-23" data-line-number="23"><span class="co">#&gt; Warning: `id()` is deprecated</span></a></code></pre></div>
<p><img src="pgog_files/figure-html/unnamed-chunk-19-1.png" width="700"></p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb37-1" data-line-number="1"><span class="kw">ggplot</span>(mtcars) <span class="op">+</span><span class="st"> </span><span class="kw">geom_icon</span>(<span class="kw">aes</span>(<span class="dt">height =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="kw">P</span>(cyl<span class="op">|</span>gear), <span class="kw">P</span>(gear)), <span class="dt">x =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(gear, vs)), <span class="dt">stat =</span> <span class="st">"icon"</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb37-2" data-line-number="2"><span class="st">  </span><span class="kw">coord_fixed</span>()</a>
<a class="sourceLine" id="cb37-3" data-line-number="3"><span class="co">#&gt;   marg cond      aes level</span></a>
<a class="sourceLine" id="cb37-4" data-line-number="4"><span class="co">#&gt; 1 gear      x.height     1</span></a>
<a class="sourceLine" id="cb37-5" data-line-number="5"><span class="co">#&gt; 2  cyl gear   height     2</span></a>
<a class="sourceLine" id="cb37-6" data-line-number="6"><span class="co">#&gt; Don't know how to automatically pick scale for object of type pgog. Defaulting to continuous.</span></a>
<a class="sourceLine" id="cb37-7" data-line-number="7"><span class="co">#&gt; Don't know how to automatically pick scale for object of type pgog. Defaulting to continuous.</span></a></code></pre></div>
<p><img src="pgog_files/figure-html/unnamed-chunk-20-1.png" width="700"></p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb38-1" data-line-number="1"><span class="kw">ggplot</span>(mtcars) <span class="op">+</span><span class="st"> </span><span class="kw">geom_icon</span>(<span class="kw">aes</span>(<span class="dt">height =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="kw">P</span>(cyl<span class="op">|</span>carb)), <span class="dt">y=</span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(carb)), <span class="dt">stat =</span> <span class="st">"icon"</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb38-2" data-line-number="2"><span class="st">  </span><span class="co"># scale_fill_brewer(palette = "Accent") + </span></a>
<a class="sourceLine" id="cb38-3" data-line-number="3"><span class="st">  </span><span class="co"># theme_minimal() + </span></a>
<a class="sourceLine" id="cb38-4" data-line-number="4"><span class="st">  </span><span class="ot">NULL</span></a>
<a class="sourceLine" id="cb38-5" data-line-number="5"><span class="co">#&gt;   marg cond    aes level</span></a>
<a class="sourceLine" id="cb38-6" data-line-number="6"><span class="co">#&gt; 1    1 carb y.cond     1</span></a>
<a class="sourceLine" id="cb38-7" data-line-number="7"><span class="co">#&gt; 2  cyl carb height     2</span></a>
<a class="sourceLine" id="cb38-8" data-line-number="8"><span class="co">#&gt; Warning: Outer names are only allowed for unnamed scalar atomic inputs</span></a>
<a class="sourceLine" id="cb38-9" data-line-number="9"></a>
<a class="sourceLine" id="cb38-10" data-line-number="10"><span class="co">#&gt; Warning: Outer names are only allowed for unnamed scalar atomic inputs</span></a>
<a class="sourceLine" id="cb38-11" data-line-number="11"></a>
<a class="sourceLine" id="cb38-12" data-line-number="12"><span class="co">#&gt; Warning: Outer names are only allowed for unnamed scalar atomic inputs</span></a>
<a class="sourceLine" id="cb38-13" data-line-number="13"><span class="co">#&gt; Don't know how to automatically pick scale for object of type pgog. Defaulting to continuous.</span></a>
<a class="sourceLine" id="cb38-14" data-line-number="14"><span class="co">#&gt; Don't know how to automatically pick scale for object of type pgog. Defaulting to continuous.</span></a>
<a class="sourceLine" id="cb38-15" data-line-number="15"><span class="co">#&gt; Warning: Outer names are only allowed for unnamed scalar atomic inputs</span></a>
<a class="sourceLine" id="cb38-16" data-line-number="16"></a>
<a class="sourceLine" id="cb38-17" data-line-number="17"><span class="co">#&gt; Warning: Outer names are only allowed for unnamed scalar atomic inputs</span></a>
<a class="sourceLine" id="cb38-18" data-line-number="18"></a>
<a class="sourceLine" id="cb38-19" data-line-number="19"><span class="co">#&gt; Warning: Outer names are only allowed for unnamed scalar atomic inputs</span></a>
<a class="sourceLine" id="cb38-20" data-line-number="20"><span class="co">#&gt; Warning: `id()` is deprecated</span></a></code></pre></div>
<p><img src="pgog_files/figure-html/unnamed-chunk-21-1.png" width="700"></p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb39-1" data-line-number="1"><span class="kw">ggplot</span>(mtcars) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb39-2" data-line-number="2"><span class="st">  </span><span class="kw">geom_icon</span>(<span class="kw">aes</span>(<span class="dt">height =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="kw">P</span>(cyl<span class="op">|</span>gear, vs)), <span class="dt">x =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(gear), <span class="dt">y=</span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(vs))) <span class="op">+</span></a>
<a class="sourceLine" id="cb39-3" data-line-number="3"><span class="st">  </span><span class="co"># geom_bloc(aes(height = c(P(cyl|gear, vs)), x = c(gear), y=c(vs))) + </span></a>
<a class="sourceLine" id="cb39-4" data-line-number="4"><span class="st">  </span><span class="kw">coord_fixed</span>()</a>
<a class="sourceLine" id="cb39-5" data-line-number="5"><span class="co">#&gt;   marg    cond    aes level</span></a>
<a class="sourceLine" id="cb39-6" data-line-number="6"><span class="co">#&gt; 1    1      vs y.cond     1</span></a>
<a class="sourceLine" id="cb39-7" data-line-number="7"><span class="co">#&gt; 2    1    gear x.cond     2</span></a>
<a class="sourceLine" id="cb39-8" data-line-number="8"><span class="co">#&gt; 3  cyl gear,vs height     3</span></a>
<a class="sourceLine" id="cb39-9" data-line-number="9"><span class="co">#&gt; Warning: Outer names are only allowed for unnamed scalar atomic inputs</span></a>
<a class="sourceLine" id="cb39-10" data-line-number="10"></a>
<a class="sourceLine" id="cb39-11" data-line-number="11"><span class="co">#&gt; Warning: Outer names are only allowed for unnamed scalar atomic inputs</span></a>
<a class="sourceLine" id="cb39-12" data-line-number="12"></a>
<a class="sourceLine" id="cb39-13" data-line-number="13"><span class="co">#&gt; Warning: Outer names are only allowed for unnamed scalar atomic inputs</span></a>
<a class="sourceLine" id="cb39-14" data-line-number="14"><span class="co">#&gt; Don't know how to automatically pick scale for object of type pgog. Defaulting to continuous.</span></a>
<a class="sourceLine" id="cb39-15" data-line-number="15"><span class="co">#&gt; Don't know how to automatically pick scale for object of type pgog. Defaulting to continuous.</span></a>
<a class="sourceLine" id="cb39-16" data-line-number="16"><span class="co">#&gt; Warning: Outer names are only allowed for unnamed scalar atomic inputs</span></a>
<a class="sourceLine" id="cb39-17" data-line-number="17"></a>
<a class="sourceLine" id="cb39-18" data-line-number="18"><span class="co">#&gt; Warning: Outer names are only allowed for unnamed scalar atomic inputs</span></a>
<a class="sourceLine" id="cb39-19" data-line-number="19"></a>
<a class="sourceLine" id="cb39-20" data-line-number="20"><span class="co">#&gt; Warning: Outer names are only allowed for unnamed scalar atomic inputs</span></a>
<a class="sourceLine" id="cb39-21" data-line-number="21"><span class="co">#&gt; Warning: `id()` is deprecated</span></a></code></pre></div>
<p><img src="pgog_files/figure-html/unnamed-chunk-22-1.png" width="700"></p>
<div id="vspine" class="section level2">
<h2 class="hasAnchor">
<a href="#vspine" class="anchor"></a>vspine</h2>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb40-1" data-line-number="1"><span class="kw">ggplot</span>(mtcars) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb40-2" data-line-number="2"><span class="st">  </span><span class="kw">geom_icon</span>(<span class="kw">aes</span>(<span class="dt">height =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="kw">P</span>(cyl)))) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb40-3" data-line-number="3"><span class="st">  </span><span class="co"># geom_bloc(aes(height = c(P(cyl)))) + </span></a>
<a class="sourceLine" id="cb40-4" data-line-number="4"><span class="st">  </span><span class="kw">coord_fixed</span>()</a>
<a class="sourceLine" id="cb40-5" data-line-number="5"><span class="co">#&gt;   marg cond    aes level</span></a>
<a class="sourceLine" id="cb40-6" data-line-number="6"><span class="co">#&gt; 1  cyl      height     1</span></a>
<a class="sourceLine" id="cb40-7" data-line-number="7"><span class="co">#&gt; Warning: Outer names are only allowed for unnamed scalar atomic inputs</span></a>
<a class="sourceLine" id="cb40-8" data-line-number="8"></a>
<a class="sourceLine" id="cb40-9" data-line-number="9"><span class="co">#&gt; Warning: Outer names are only allowed for unnamed scalar atomic inputs</span></a>
<a class="sourceLine" id="cb40-10" data-line-number="10"><span class="co">#&gt; Don't know how to automatically pick scale for object of type pgog. Defaulting to continuous.</span></a>
<a class="sourceLine" id="cb40-11" data-line-number="11"><span class="co">#&gt; Don't know how to automatically pick scale for object of type pgog. Defaulting to continuous.</span></a>
<a class="sourceLine" id="cb40-12" data-line-number="12"><span class="co">#&gt; Warning: Outer names are only allowed for unnamed scalar atomic inputs</span></a>
<a class="sourceLine" id="cb40-13" data-line-number="13"></a>
<a class="sourceLine" id="cb40-14" data-line-number="14"><span class="co">#&gt; Warning: Outer names are only allowed for unnamed scalar atomic inputs</span></a></code></pre></div>
<p><img src="pgog_files/figure-html/unnamed-chunk-23-1.png" width="700"></p>
</div>
<div id="hspine" class="section level2">
<h2 class="hasAnchor">
<a href="#hspine" class="anchor"></a>hspine</h2>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb41-1" data-line-number="1"><span class="kw">ggplot</span>(mtcars) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb41-2" data-line-number="2"><span class="st">  </span><span class="kw">geom_icon</span>(<span class="kw">aes</span>(<span class="dt">width =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="kw">P</span>(cyl)))) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb41-3" data-line-number="3"><span class="st">  </span><span class="kw">geom_bloc</span>(<span class="kw">aes</span>(<span class="dt">width =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="kw">P</span>(cyl)))) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb41-4" data-line-number="4"><span class="st">  </span><span class="kw">coord_fixed</span>()</a>
<a class="sourceLine" id="cb41-5" data-line-number="5"><span class="co">#&gt;   marg cond   aes level</span></a>
<a class="sourceLine" id="cb41-6" data-line-number="6"><span class="co">#&gt; 1  cyl      width     1</span></a>
<a class="sourceLine" id="cb41-7" data-line-number="7"><span class="co">#&gt; Warning: Outer names are only allowed for unnamed scalar atomic inputs</span></a>
<a class="sourceLine" id="cb41-8" data-line-number="8"></a>
<a class="sourceLine" id="cb41-9" data-line-number="9"><span class="co">#&gt; Warning: Outer names are only allowed for unnamed scalar atomic inputs</span></a>
<a class="sourceLine" id="cb41-10" data-line-number="10"><span class="co">#&gt;   marg cond   aes level</span></a>
<a class="sourceLine" id="cb41-11" data-line-number="11"><span class="co">#&gt; 1  cyl      width     1</span></a>
<a class="sourceLine" id="cb41-12" data-line-number="12"><span class="co">#&gt; Warning: Outer names are only allowed for unnamed scalar atomic inputs</span></a>
<a class="sourceLine" id="cb41-13" data-line-number="13"></a>
<a class="sourceLine" id="cb41-14" data-line-number="14"><span class="co">#&gt; Warning: Outer names are only allowed for unnamed scalar atomic inputs</span></a>
<a class="sourceLine" id="cb41-15" data-line-number="15"><span class="co">#&gt; Aesthetic mapping: </span></a>
<a class="sourceLine" id="cb41-16" data-line-number="16"><span class="co">#&gt; * `p.cyl` -&gt; `cyl`</span></a>
<a class="sourceLine" id="cb41-17" data-line-number="17"><span class="co">#&gt; * `x`     -&gt; 1</span></a>
<a class="sourceLine" id="cb41-18" data-line-number="18"><span class="co">#&gt; * `y`     -&gt; 1</span></a>
<a class="sourceLine" id="cb41-19" data-line-number="19"><span class="co">#&gt; Don't know how to automatically pick scale for object of type pgog. Defaulting to continuous.</span></a>
<a class="sourceLine" id="cb41-20" data-line-number="20"><span class="co">#&gt; Don't know how to automatically pick scale for object of type pgog. Defaulting to continuous.</span></a>
<a class="sourceLine" id="cb41-21" data-line-number="21"><span class="co">#&gt; Warning: Outer names are only allowed for unnamed scalar atomic inputs</span></a>
<a class="sourceLine" id="cb41-22" data-line-number="22"></a>
<a class="sourceLine" id="cb41-23" data-line-number="23"><span class="co">#&gt; Warning: Outer names are only allowed for unnamed scalar atomic inputs</span></a>
<a class="sourceLine" id="cb41-24" data-line-number="24"></a>
<a class="sourceLine" id="cb41-25" data-line-number="25"><span class="co">#&gt; Warning: Outer names are only allowed for unnamed scalar atomic inputs</span></a>
<a class="sourceLine" id="cb41-26" data-line-number="26"></a>
<a class="sourceLine" id="cb41-27" data-line-number="27"><span class="co">#&gt; Warning: Outer names are only allowed for unnamed scalar atomic inputs</span></a>
<a class="sourceLine" id="cb41-28" data-line-number="28"><span class="co">#&gt; Defaulting to mosaic plots. Use `stat=blocdensity` to force density plots</span></a></code></pre></div>
<p><img src="pgog_files/figure-html/unnamed-chunk-24-1.png" width="700"></p>
<pre><code>#&gt; Called from: f(..., self = self)
#&gt; debug: if ("density" %in% names(data)) {
#&gt;     data &lt;- transform(data[order(data$PANEL, data$group, data$x), 
#&gt;         ], ymin = 0, ymax = y)
#&gt;     if ("height" %in% names(data)) {
#&gt;         if (is.null(params$panel_scaling)) {
#&gt;             params$panel_scaling &lt;- TRUE
#&gt;         }
#&gt;         yrange = max(data$y) - min(data$y)
#&gt;         n = length(unique(data$y))
#&gt;         if (n &lt; 2) {
#&gt;             hmax &lt;- max(data$height, na.rm = TRUE)
#&gt;             iscale &lt;- 1
#&gt;         }
#&gt;         else {
#&gt;             if (params$panel_scaling) {
#&gt;                 heights &lt;- split(data$height, data$PANEL)
#&gt;                 max_heights &lt;- vapply(heights, max, numeric(1), 
#&gt;                   na.rm = TRUE)
#&gt;                 hmax &lt;- max_heights[data$PANEL]
#&gt;                 iscale &lt;- yrange/((n - 1) * hmax)
#&gt;             }
#&gt;             else {
#&gt;                 hmax &lt;- max(data$height, na.rm = TRUE)
#&gt;                 iscale &lt;- yrange/((n - 1) * hmax)
#&gt;             }
#&gt;         }
#&gt;         data &lt;- cbind(data, iscale)
#&gt;         if (!"scale" %in% names(data)) {
#&gt;             if (!"scale" %in% names(params)) 
#&gt;                 data &lt;- cbind(data, scale = self$default_aes$scale)
#&gt;             else data &lt;- cbind(data, scale = params$scale)
#&gt;         }
#&gt;         if (!"rel_min_height" %in% names(data)) {
#&gt;             if (!"rel_min_height" %in% names(params)) 
#&gt;                 data &lt;- cbind(data, rel_min_height = self$default_aes$rel_min_height)
#&gt;             else data &lt;- cbind(data, rel_min_height = params$rel_min_height)
#&gt;         }
#&gt;         data &lt;- transform(data, ymin = y, ymax = y + iscale * 
#&gt;             scale * height, min_height = hmax * rel_min_height)
#&gt;         return(data)
#&gt;     }
#&gt;     data
#&gt; } else {
#&gt;     subset(data, level == max(data$level))
#&gt; }
#&gt; debug: subset(data, level == max(data$level))</code></pre>
</div>
<div id="dotplots" class="section level2">
<h2 class="hasAnchor">
<a href="#dotplots" class="anchor"></a>dotplots</h2>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb43-1" data-line-number="1"><span class="kw">ggplot</span>(mtcars) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb43-2" data-line-number="2"><span class="st">  </span><span class="kw">geom_icon</span>(<span class="kw">aes</span>(<span class="dt">height =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="kw">P</span>(cyl))))</a>
<a class="sourceLine" id="cb43-3" data-line-number="3"><span class="co">#&gt;   marg cond    aes level</span></a>
<a class="sourceLine" id="cb43-4" data-line-number="4"><span class="co">#&gt; 1  cyl      height     1</span></a>
<a class="sourceLine" id="cb43-5" data-line-number="5"><span class="co">#&gt; Warning: Outer names are only allowed for unnamed scalar atomic inputs</span></a>
<a class="sourceLine" id="cb43-6" data-line-number="6"></a>
<a class="sourceLine" id="cb43-7" data-line-number="7"><span class="co">#&gt; Warning: Outer names are only allowed for unnamed scalar atomic inputs</span></a>
<a class="sourceLine" id="cb43-8" data-line-number="8"><span class="co">#&gt; Don't know how to automatically pick scale for object of type pgog. Defaulting to continuous.</span></a>
<a class="sourceLine" id="cb43-9" data-line-number="9"><span class="co">#&gt; Don't know how to automatically pick scale for object of type pgog. Defaulting to continuous.</span></a>
<a class="sourceLine" id="cb43-10" data-line-number="10"><span class="co">#&gt; Warning: Outer names are only allowed for unnamed scalar atomic inputs</span></a>
<a class="sourceLine" id="cb43-11" data-line-number="11"></a>
<a class="sourceLine" id="cb43-12" data-line-number="12"><span class="co">#&gt; Warning: Outer names are only allowed for unnamed scalar atomic inputs</span></a></code></pre></div>
<p><img src="pgog_files/figure-html/unnamed-chunk-25-1.png" width="700"></p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">

        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#override-default-themes">Override default themes</a></li>
      <li>
<a href="#geom_bloc">geom_bloc</a><ul class="nav nav-pills nav-stacked">
<li><a href="#product-plots">product plots</a></li>
      <li><a href="#density-plots">density plots</a></li>
      </ul>
</li>
      <li>
<a href="#geom_icon">geom_icon</a><ul class="nav nav-pills nav-stacked">
<li><a href="#vspine">vspine</a></li>
      <li><a href="#hspine">hspine</a></li>
      <li><a href="#dotplots">dotplots</a></li>
      </ul>
</li>
      </ul>
</div>
      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by Xiaoying Pu.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
